function push_err(){err_stack.push(err_info)}function pop_err(){err_info=err_stack.pop()}function stackTrace(){if(!err_info.length)return"";for(var t=err_info+"\n",e=err_stack.length-1;e>0;--e)t+=err_stack[e]+"\n";return t}function print(t){var e=document.getElementById("GameConsole");return e?(e.value+=t+"\n",e.scrollTop=e.scrollHeight-e.clientHeight):void 0!=window.console&&window.console.log(t),0}function alertError(t){("string"!=typeof t||""!=t)&&alert("Monkey Runtime Error : "+t.toString()+"\n\n"+stackTrace())}function error(t){throw t}function debugLog(t){void 0!=window.console&&window.console.log(t)}function debugStop(){}function dbg_object(t){return t?t:(error("Null object access"),void 0)}function dbg_charCodeAt(t,e){return(0>e||e>=t.length)&&error("Character index out of range"),t.charCodeAt(e)}function dbg_array(t,e){return(0>e||e>=t.length)&&error("Array index out of range"),dbg_index=e,t}function new_bool_array(t){for(var e=Array(t),_=0;t>_;++_)e[_]=!1;return e}function new_number_array(t){for(var e=Array(t),_=0;t>_;++_)e[_]=0;return e}function new_string_array(t){for(var e=Array(t),_=0;t>_;++_)e[_]="";return e}function new_array_array(t){for(var e=Array(t),_=0;t>_;++_)e[_]=[];return e}function new_object_array(t){for(var e=Array(t),_=0;t>_;++_)e[_]=null;return e}function resize_bool_array(t,e){var _=t.length;if(t=t.slice(0,e),_>=e)return t;for(t.length=e;e>_;)t[_++]=!1;return t}function resize_number_array(t,e){var _=t.length;if(t=t.slice(0,e),_>=e)return t;for(t.length=e;e>_;)t[_++]=0;return t}function resize_string_array(t,e){var _=t.length;if(t=t.slice(0,e),_>=e)return t;for(t.length=e;e>_;)t[_++]="";return t}function resize_array_array(t,e){var _=t.length;if(t=t.slice(0,e),_>=e)return t;for(t.length=e;e>_;)t[_++]=[];return t}function resize_object_array(t,e){var _=t.length;if(t=t.slice(0,e),_>=e)return t;for(t.length=e;e>_;)t[_++]=null;return t}function string_compare(t,e){var _,i,A=Math.min(t.length,e.length);for(_=0;A>_;++_)if(i=t.charCodeAt(_)-e.charCodeAt(_))return i;return t.length-e.length}function string_replace(t,e,_){for(var i=0;;){if(i=t.indexOf(e,i),-1==i)return t;t=t.substring(0,i)+_+t.substring(i+e.length),i+=_.length}}function string_trim(t){for(var e=0,_=t.length;_>e&&t.charCodeAt(e)<=32;)e+=1;for(;_>e&&t.charCodeAt(_-1)<=32;)_-=1;return t.slice(e,_)}function string_startswith(t,e){return e.length<=t.length&&t.slice(0,e.length)==e}function string_endswith(t,e){return e.length<=t.length&&t.slice(t.length-e.length,t.length)==e}function string_tochars(t){for(var e=new Array(t.length),_=0;_<t.length;++_)e[_]=t.charCodeAt(_);return e}function string_fromchars(t){var e,_="";for(e=0;e<t.length;++e)_+=String.fromCharCode(t[e]);return _}function object_downcast(t,e){return t instanceof e?t:null}function object_implements(t,e){return t&&t.implments&&t.implments[e]?t:null}function extend_class(t){var e=function(){};return e.prototype=t.prototype,new e}function ThrowableObject(){}function BBGameEvent(){}function BBGameDelegate(){}function BBGame(){BBGame._game=this,this._delegate=null,this._keyboardEnabled=!1,this._updateRate=0,this._started=!1,this._suspended=!1,this._debugExs="debug"==CFG_CONFIG,this._startms=Date.now()}function BBHtml5Game(t){BBGame.call(this),BBHtml5Game._game=this,this._canvas=t,this._loading=0,this._timerSeq=0,this._gl=null,"1"==CFG_OPENGL_GLES20_ENABLED&&(this._gl=this._canvas.getContext("webgl"),this._gl||(this._gl=this._canvas.getContext("experimental-webgl")),this._gl||this.Die("Can't create WebGL"),gl=this._gl)}function BBMonkeyGame(t){BBHtml5Game.call(this,t)}function gxtkGraphics(){this.game=BBHtml5Game.Html5Game(),this.canvas=this.game.GetCanvas(),this.width=this.canvas.width,this.height=this.canvas.height,this.gl=null,this.gc=this.canvas.getContext("2d"),this.tmpCanvas=null,this.r=255,this.b=255,this.g=255,this.white=!0,this.color="rgb(255,255,255)",this.alpha=1,this.blend="source-over",this.ix=1,this.iy=0,this.jx=0,this.jy=1,this.tx=0,this.ty=0,this.tformed=!1,this.scissorX=0,this.scissorY=0,this.scissorWidth=0,this.scissorHeight=0,this.clipped=!1}function gxtkSurface(t,e){this.image=t,this.graphics=e,this.swidth=t.meta_width,this.sheight=t.meta_height}function gxtkChannel(){this.sample=null,this.audio=null,this.volume=1,this.pan=0,this.rate=1,this.flags=0,this.state=0}function gxtkAudio(){this.game=BBHtml5Game.Html5Game(),this.okay="undefined"!=typeof Audio,this.music=null,this.channels=new Array(33);for(var t=0;33>t;++t)this.channels[t]=new gxtkChannel,this.okay||(this.channels[t].state=-1)}function gxtkSample(t){this.audio=t,this.free=new Array,this.insts=new Array}function BBThread(){this.running=!1}function BBAsyncImageLoaderThread(){BBThread.call(this)}function BBAsyncSoundLoaderThread(){BBThread.call(this)}function c_App(){Object.call(this)}function c_game(){c_App.call(this),this.m_eng=null,this.m_atlas=null,this.m_layerBackground=null,this.m_layerGame=null,this.m_layerFX=null,this.m_layerUI=null,this.m_layerTitle=null,this.m_layerScore=null,this.m_player=null,this.m_shield=null,this.m_sndExplo=null,this.m_sndShot=null,this.m_font1=null,this.m_score=0,this.m_txtScore=null,this.m_levelNumber=0,this.m_txtLevel=null,this.m_cometCount=0,this.m_txtComets=null,this.m_lives=0,this.m_txtLives=null,this.m_txtHighScores=new_object_array(10),this.m_gameMode=1,this.m_lastTime=0,this.m_deltaTime=0,this.m_obj=null}function c_GameDelegate(){BBGameDelegate.call(this),this.m__graphics=null,this.m__audio=null,this.m__input=null}function bbMain(){return bb_RockSmash_g=c_game.m_new.call(new c_game),0}function bb_graphics_SetGraphicsDevice(t){return bb_graphics_device=t,0}function c_Image(){Object.call(this),this.m_surface=null,this.m_width=0,this.m_height=0,this.m_frames=[],this.m_flags=0,this.m_tx=0,this.m_ty=0,this.m_source=null}function c_GraphicsContext(){Object.call(this),this.m_defaultFont=null,this.m_font=null,this.m_firstChar=0,this.m_matrixSp=0,this.m_ix=1,this.m_iy=0,this.m_jx=0,this.m_jy=1,this.m_tx=0,this.m_ty=0,this.m_tformed=0,this.m_matDirty=0,this.m_color_r=0,this.m_color_g=0,this.m_color_b=0,this.m_alpha=0,this.m_blend=0,this.m_scissor_x=0,this.m_scissor_y=0,this.m_scissor_width=0,this.m_scissor_height=0,this.m_matrixStack=new_number_array(192)}function bb_data_FixDataPath(t){var e=t.indexOf(":/",0);return-1!=e&&t.indexOf("/",0)==e+1?t:string_startswith(t,"./")||string_startswith(t,"/")?t:"monkey://data/"+t}function c_Frame(){Object.call(this),this.m_x=0,this.m_y=0}function bb_graphics_LoadImage(t,e,_){var i=bb_graphics_device.LoadSurface(bb_data_FixDataPath(t));return null!=i?c_Image.m_new.call(new c_Image).p_Init(i,e,_):null}function bb_graphics_LoadImage2(t,e,_,i,A){var n=bb_graphics_LoadImage(t,1,0);return null!=n?n.p_GrabImage(0,0,e,_,i,A):null}function bb_graphics_SetFont(t,e){return null==t&&(null==bb_graphics_context.m_defaultFont&&(bb_graphics_context.m_defaultFont=bb_graphics_LoadImage("mojo_font.png",96,2)),t=bb_graphics_context.m_defaultFont,e=32),bb_graphics_context.m_font=t,bb_graphics_context.m_firstChar=e,0}function bb_audio_SetAudioDevice(t){return bb_audio_device=t,0}function c_InputDevice(){Object.call(this),this.m__joyStates=new_object_array(4),this.m__keyDown=new_bool_array(512),this.m__keyHitPut=0,this.m__keyHitQueue=new_number_array(33),this.m__keyHit=new_number_array(512),this.m__charGet=0,this.m__charPut=0,this.m__charQueue=new_number_array(32),this.m__mouseX=0,this.m__mouseY=0,this.m__touchX=new_number_array(32),this.m__touchY=new_number_array(32),this.m__accelX=0,this.m__accelY=0,this.m__accelZ=0}function c_JoyState(){Object.call(this),this.m_joyx=new_number_array(2),this.m_joyy=new_number_array(2),this.m_joyz=new_number_array(2),this.m_buttons=new_bool_array(32)}function bb_input_SetInputDevice(t){return bb_input_device=t,0}function bb_graphics_SetMatrix(t,e,_,i,A,n){return bb_graphics_context.m_ix=t,bb_graphics_context.m_iy=e,bb_graphics_context.m_jx=_,bb_graphics_context.m_jy=i,bb_graphics_context.m_tx=A,bb_graphics_context.m_ty=n,bb_graphics_context.m_tformed=1!=t||0!=e||0!=_||1!=i||0!=A||0!=n?1:0,bb_graphics_context.m_matDirty=1,0}function bb_graphics_SetMatrix2(t){return bb_graphics_SetMatrix(t[0],t[1],t[2],t[3],t[4],t[5]),0}function bb_graphics_SetColor(t,e,_){return bb_graphics_context.m_color_r=t,bb_graphics_context.m_color_g=e,bb_graphics_context.m_color_b=_,bb_graphics_renderDevice.SetColor(t,e,_),0}function bb_graphics_SetAlpha(t){return bb_graphics_context.m_alpha=t,bb_graphics_renderDevice.SetAlpha(t),0}function bb_graphics_SetBlend(t){return bb_graphics_context.m_blend=t,bb_graphics_renderDevice.SetBlend(t),0}function bb_graphics_DeviceWidth(){return bb_graphics_device.Width()}function bb_graphics_DeviceHeight(){return bb_graphics_device.Height()}function bb_graphics_SetScissor(t,e,_,i){return bb_graphics_context.m_scissor_x=t,bb_graphics_context.m_scissor_y=e,bb_graphics_context.m_scissor_width=_,bb_graphics_context.m_scissor_height=i,bb_graphics_renderDevice.SetScissor(0|t,0|e,0|_,0|i),0}function bb_graphics_BeginRender(){return bb_graphics_renderDevice=bb_graphics_device,bb_graphics_context.m_matrixSp=0,bb_graphics_SetMatrix(1,0,0,1,0,0),bb_graphics_SetColor(255,255,255),bb_graphics_SetAlpha(1),bb_graphics_SetBlend(0),bb_graphics_SetScissor(0,0,bb_graphics_DeviceWidth(),bb_graphics_DeviceHeight()),0}function bb_graphics_EndRender(){return bb_graphics_renderDevice=null,0}function c_BBGameEvent(){Object.call(this)}function bb_app_EndApp(){return error(""),0}function bb_app_SetUpdateRate(t){return bb_app__updateRate=t,bb_app__game.SetUpdateRate(t),0}function c_ftEngine(){Object.call(this),this.m_defaultLayer=null,this.m_layerList=c_List2.m_new.call(new c_List2),this.m_defaultScene=null,this.m_sceneList=c_List3.m_new.call(new c_List3),this.m_screenWidth=0,this.m_screenHeight=0,this.m_canvasWidth=0,this.m_canvasHeight=0,this.m_lastMillisecs=bb_app_Millisecs(),this.m_timeScale=1,this.m_engineTime=0,this.m_time=0,this.m_lastTime=0,this.m_swiper=null,this.m_imgMng=null,this.m_defaultActive=!0,this.m_defaultVisible=!0,this.m_soundList=c_List5.m_new.call(new c_List5),this.m_fontList=c_List6.m_new.call(new c_List6),this.m_timerList=c_List7.m_new.call(new c_List7),this.m_isPaused=!1,this.m_delta=1,this.m_scoreList=c_ftHighScoreList.m_new.call(new c_ftHighScoreList),this.m_red=255,this.m_green=255,this.m_blue=255,this.m_autofitX=0,this.m_autofitY=0,this.m_scaleX=1,this.m_scaleY=1,this.m_lastLayerAngle=0,this.m_lastLayerScale=1,this.m_alpha=1,this.m_blendMode=0,this.m_camX=0,this.m_camY=0,this.m_maxSoundChannel=32,this.m_firstSoundChannel=0,this.m_nextSoundChannel=99,this.m_volumeSFX=1,this.m_volumeMUS=1}function c_engine(){c_ftEngine.call(this)}function c_ftLayer(){Object.call(this),this.m_objList=c_lObjList.m_new.call(new c_lObjList),this.m_engine=null,this.m_engineNode=null,this.m_isActive=!0,this.m_inUpdate=!1,this.m_transitionList=c_List8.m_new.call(new c_List8),this.m_xPos=0,this.m_yPos=0,this.m_scale=1,this.m_alpha=1,this.m_inTouch=!1,this.m_isVisible=!0,this.m_angle=0,this.m_isGUI=!1}function c_ftObject(){Object.call(this),this.m_engine=null,this.m_xPos=0,this.m_yPos=0,this.m_type=0,this.m_objImg=null,this.m_radius=1,this.m_w=0,this.m_h=0,this.m_rw=0,this.m_rh=0,this.m_layer=null,this.m_layerNode=null,this.m_isActive=!0,this.m_isVisible=!0,this.m_collType=0,this.m_handleX=.5,this.m_scaleX=1,this.m_hOffX=0,this.m_handleY=.5,this.m_scaleY=1,this.m_hOffY=0,this.m_angle=0,this.m_offAngle=0,this.m_collScale=1,this.m_isFlipV=!1,this.m_isFlipH=!1,this.m_x1c=0,this.m_y1c=0,this.m_x2c=0,this.m_y2c=0,this.m_x3c=0,this.m_y3c=0,this.m_x4c=0,this.m_y4c=0,this.m_childObjList=c_List.m_new.call(new c_List),this.m_parentObj=null,this.m_speedSpin=0,this.m_friction=0,this.m_speedMax=9999,this.m_isWrappingX=!1,this.m_isWrappingY=!1,this.m_collWith=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.m_collGroup=0,this.m_colCheck=!1,this.m_parentNode=null,this.m_objFont=null,this.m_textMode=0,this.m_text="",this.m_alpha=1,this.m_deleted=!1,this.m_isAnimated=!1,this.m_animTime=0,this.m_frameEnd=0,this.m_frameTime=10,this.m_frameLength=0,this.m_speed=0,this.m_speedAngle=0,this.m_speedX=0,this.m_speedY=0,this.m_transitionList=c_List8.m_new.call(new c_List8),this.m_timerList=c_List7.m_new.call(new c_List7),this.m_onUpdateEvent=!0,this.m_marker=null,this.m_markerNode=null,this.m_onDeleteEvent=!1,this.m_speedMin=-9999,this.m_tag=0,this.m_id=0,this.m_red=255,this.m_green=255,this.m_blue=255,this.m_blendMode=0,this.m_verts=[],this.m_frameCount=1,this.m_rox=0,this.m_roy=0,this.m_tileModSX=0,this.m_tileModSY=0,this.m_tileSizeX=0,this.m_tileSizeY=0,this.m_tileCountX=0,this.m_tileMap=[],this.m_tileCountY=0,this.m_onRenderEvent=!1}function c_List(){Object.call(this),this.m__head=c_HeadNode.m_new.call(new c_HeadNode)}function c_lObjList(){c_List.call(this),this.m_layer=null}function c_Node(){Object.call(this),this.m__succ=null,this.m__pred=null,this.m__data=null}function c_HeadNode(){c_Node.call(this)}function c_List2(){Object.call(this),this.m__head=c_HeadNode2.m_new.call(new c_HeadNode2)}function c_Node2(){Object.call(this),this.m__succ=null,this.m__pred=null,this.m__data=null}function c_HeadNode2(){c_Node2.call(this)}function c_ftScene(){Object.call(this),this.m_engine=null,this.m_layerList=c_List2.m_new.call(new c_List2)}function c_List3(){Object.call(this),this.m__head=c_HeadNode3.m_new.call(new c_HeadNode3)}function c_Node3(){Object.call(this),this.m__succ=null,this.m__pred=null,this.m__data=null}function c_HeadNode3(){c_Node3.call(this)}function bb_app_Millisecs(){return bb_app__game.Millisecs()}function c_ftSwipe(){Object.call(this),this.m_startX=new_number_array(10),this.m_startY=new_number_array(10),this.m_endX=new_number_array(10),this.m_endY=new_number_array(10),this.m_diffX=new_number_array(10),this.m_diffY=new_number_array(10),this.m_startTime=new_number_array(10),this.m_endTime=new_number_array(10),this.m_diffTime=new_number_array(10),this.m_touchActive=new_bool_array(10),this.m_angle=new_number_array(10),this.m_dist=new_number_array(10),this.m_speed=new_number_array(10),this.m_engine=null}function c_ftImageManager(){Object.call(this),this.m_engine=null,this.m_imageList=c_List4.m_new.call(new c_List4)}function bb_random_Rnd(){return bb_random_Seed=0|1664525*bb_random_Seed+1013904223,(16777215&bb_random_Seed>>8)/16777216}function bb_random_Rnd2(t,e){return bb_random_Rnd3(e-t)+t}function bb_random_Rnd3(t){return bb_random_Rnd()*t}function c_ftImage(){Object.call(this),this.m_img=null,this.m_engine=null,this.m_path="",this.m_flags=c_Image.m_DefaultFlags,this.m_frameCount=-1,this.m_imageNode=null,this.m_frameHeight=-1,this.m_frameWidth=-1,this.m_atlas=null,this.m_frameStartX=-1,this.m_frameStartY=-1,this.m_isGrabed=!1,this.m_isAtlas=!1}function c_List4(){Object.call(this),this.m__head=c_HeadNode4.m_new.call(new c_HeadNode4)}function c_Node4(){Object.call(this),this.m__succ=null,this.m__pred=null,this.m__data=null}function c_HeadNode4(){c_Node4.call(this)}function c_Enumerator(){Object.call(this),this.m__list=null,this.m__curr=null}function bb_math_Max(t,e){return t>e?t:e}function bb_math_Max2(t,e){return t>e?t:e}function bb_app_LoadString(t){return bb_app__game.LoadString(bb_data_FixDataPath(t))}function c_Enumerator2(){Object.call(this),this.m__list=null,this.m__curr=null}function c_ftSound(){Object.call(this),this.m_engine=null,this.m_name="",this.m_loop=!1,this.m_isMusic=!1,this.m_sound=null,this.m_soundNode=null,this.m_channel=0,this.m_volume=1,this.m_pan=0,this.m_rate=1,this.m_isPaused=!1}function c_Sound(){Object.call(this),this.m_sample=null}function bb_audio_LoadSound(t){var e=bb_audio_device.LoadSample(bb_data_FixDataPath(t));return null!=e?c_Sound.m_new.call(new c_Sound,e):null}function c_List5(){Object.call(this),this.m__head=c_HeadNode5.m_new.call(new c_HeadNode5)}function c_Node5(){Object.call(this),this.m__succ=null,this.m__pred=null,this.m__data=null}function c_HeadNode5(){c_Node5.call(this)}function c_ftFont(){Object.call(this),this.m_lineHeight=0,this.m_pageCount=0,this.m_pages=[],this.m_filename="",this.m_charMap=c_IntMap.m_new.call(new c_IntMap)}function c_ftChar(){Object.call(this),this.m_id=0,this.m_x=0,this.m_y=0,this.m_width=0,this.m_height=0,this.m_xoff=0,this.m_yoff=0,this.m_xadv=0,this.m_page=0}function c_Map(){Object.call(this),this.m_root=null}function c_IntMap(){c_Map.call(this)}function c_Node6(){Object.call(this),this.m_key=0,this.m_right=null,this.m_left=null,this.m_value=null,this.m_color=0,this.m_parent=null}function c_List6(){Object.call(this),this.m__head=c_HeadNode6.m_new.call(new c_HeadNode6)}function c_Node7(){Object.call(this),this.m__succ=null,this.m__pred=null,this.m__data=null}function c_HeadNode6(){c_Node7.call(this)}function bb_input_KeyHit(t){return bb_input_device.p_KeyHit(t)}function c_ftTimer(){Object.call(this),this.m_deleted=!1,this.m_duration=0,this.m_currTime=0,this.m_engine=null,this.m_isPaused=!1,this.m_obj=null,this.m_id=0,this.m_loop=0,this.m_timerNode=null,this.m_intervall=0}function c_List7(){Object.call(this),this.m__head=c_HeadNode7.m_new.call(new c_HeadNode7)}function c_Node8(){Object.call(this),this.m__succ=null,this.m__pred=null,this.m__data=null}function c_HeadNode7(){c_Node8.call(this)}function c_BackwardsList(){Object.call(this),this.m__list=null}function c_BackwardsEnumerator(){Object.call(this),this.m__list=null,this.m__curr=null}function c_Enumerator3(){Object.call(this),this.m__list=null,this.m__curr=null}function c_ftTrans(){Object.call(this),this.m_deleted=!1,this.m_currTime=0,this.m_engine=null,this.m_isPaused=!1,this.m_duration=0,this.m_entryList=c_List9.m_new.call(new c_List9),this.m_tween=null,this.m_finishID=0,this.m_obj=null,this.m_layer=null,this.m_transNode=null}function c_List8(){Object.call(this),this.m__head=c_HeadNode8.m_new.call(new c_HeadNode8)}function c_Node9(){Object.call(this),this.m__succ=null,this.m__pred=null,this.m__data=null}function c_HeadNode8(){c_Node9.call(this)}function c_Enumerator4(){Object.call(this),this.m__list=null,this.m__curr=null}function c_ftTransEntry(){Object.call(this),this.m_timeLapsed=0,this.m_obj=null,this.m_typ=0,this.m_e_x=0,this.m_e_y=0,this.m_e_rot=0,this.m_e_scale=0,this.m_e_alpha=0,this.m_s_x=0,this.m_duration=0,this.m_s_y=0,this.m_rot=0,this.m_scale=0,this.m_alpha=0,this.m_layer=null,this.m_x=0,this.m_y=0}function c_List9(){Object.call(this),this.m__head=c_HeadNode9.m_new.call(new c_HeadNode9)}function c_Node10(){Object.call(this),this.m__succ=null,this.m__pred=null,this.m__data=null}function c_HeadNode9(){c_Node10.call(this)}function c_Enumerator5(){Object.call(this),this.m__list=null,this.m__curr=null}function c_Tween(){Object.call(this),this.m_equation=null}function c_TweenEquationCall(){Object.call(this)}function c_Enumerator6(){Object.call(this),this.m__list=null,this.m__curr=null}function c_BackwardsList2(){Object.call(this),this.m__list=null}function c_BackwardsEnumerator2(){Object.call(this),this.m__list=null,this.m__curr=null}function c_ftMarker(){Object.call(this)}function c_tPointS(){Object.call(this),this.m_x=0,this.m_y=0}function c_tLine2D(){Object.call(this),this.m_p1=null,this.m_p2=null}function bb_math_Abs(t){return t>=0?t:-t}function bb_math_Abs2(t){return t>=0?t:-t}function bb_math_Min(t,e){return e>t?t:e}function bb_math_Min2(t,e){return e>t?t:e}function bb_app_LoadState(){return bb_app__game.LoadState()}function c_ftHighScoreList(){Object.call(this),this.m_entryList=c_List10.m_new.call(new c_List10),this.m_entryCount=10}function c_ftHighScoreEntry(){Object.call(this),this.m_value=0,this.m_name=""}function c_List10(){Object.call(this),this.m__head=c_HeadNode10.m_new.call(new c_HeadNode10)}function c_Node11(){Object.call(this),this.m__succ=null,this.m__pred=null,this.m__data=null}function c_HeadNode10(){c_Node11.call(this)}function c_Enumerator7(){Object.call(this),this.m__list=null,this.m__curr=null}function bb_graphics_Cls(t,e,_){return bb_graphics_renderDevice.Cls(t,e,_),0}function bb_graphics_PushMatrix(){var t=bb_graphics_context.m_matrixSp;return bb_graphics_context.m_matrixStack[t+0]=bb_graphics_context.m_ix,bb_graphics_context.m_matrixStack[t+1]=bb_graphics_context.m_iy,bb_graphics_context.m_matrixStack[t+2]=bb_graphics_context.m_jx,bb_graphics_context.m_matrixStack[t+3]=bb_graphics_context.m_jy,bb_graphics_context.m_matrixStack[t+4]=bb_graphics_context.m_tx,bb_graphics_context.m_matrixStack[t+5]=bb_graphics_context.m_ty,bb_graphics_context.m_matrixSp=t+6,0}function bb_graphics_Transform(t,e,_,i,A,n){var s=t*bb_graphics_context.m_ix+e*bb_graphics_context.m_jx,r=t*bb_graphics_context.m_iy+e*bb_graphics_context.m_jy,a=_*bb_graphics_context.m_ix+i*bb_graphics_context.m_jx,m=_*bb_graphics_context.m_iy+i*bb_graphics_context.m_jy,o=A*bb_graphics_context.m_ix+n*bb_graphics_context.m_jx+bb_graphics_context.m_tx,h=A*bb_graphics_context.m_iy+n*bb_graphics_context.m_jy+bb_graphics_context.m_ty;return bb_graphics_SetMatrix(s,r,a,m,o,h),0}function bb_graphics_Transform2(t){return bb_graphics_Transform(t[0],t[1],t[2],t[3],t[4],t[5]),0}function bb_graphics_Translate(t,e){return bb_graphics_Transform(1,0,0,1,t,e),0}function bb_graphics_Scale(t,e){return bb_graphics_Transform(t,0,0,e,0,0),0}function bb_graphics_Rotate(t){return bb_graphics_Transform(Math.cos(t*D2R),-Math.sin(t*D2R),Math.sin(t*D2R),Math.cos(t*D2R),0,0),0}function bb_cftMisc_RotateDisplay(t,e,_){bb_graphics_Translate(t,e),bb_graphics_Rotate(_),bb_graphics_Translate(-t,-e)}function bb_graphics_DrawPoint(t,e){return bb_graphics_context.p_Validate(),bb_graphics_renderDevice.DrawPoint(t,e),0}function bb_graphics_DrawCircle(t,e,_){return bb_graphics_context.p_Validate(),bb_graphics_renderDevice.DrawOval(t-_,e-_,2*_,2*_),0}function bb_graphics_DrawLine(t,e,_,i){return bb_graphics_context.p_Validate(),bb_graphics_renderDevice.DrawLine(t,e,_,i),0}function bb_graphics_PopMatrix(){var t=bb_graphics_context.m_matrixSp-6;return bb_graphics_SetMatrix(bb_graphics_context.m_matrixStack[t+0],bb_graphics_context.m_matrixStack[t+1],bb_graphics_context.m_matrixStack[t+2],bb_graphics_context.m_matrixStack[t+3],bb_graphics_context.m_matrixStack[t+4],bb_graphics_context.m_matrixStack[t+5]),bb_graphics_context.m_matrixSp=t,0}function bb_graphics_DrawOval(t,e,_,i){return bb_graphics_context.p_Validate(),bb_graphics_renderDevice.DrawOval(t,e,_,i),0}function bb_graphics_DrawPoly(t){return bb_graphics_context.p_Validate(),bb_graphics_renderDevice.DrawPoly(t),0}function bb_graphics_DrawPoly2(t,e,_){var i=e.m_frames[_];return bb_graphics_renderDevice.DrawPoly2(t,e.m_surface,i.m_x,i.m_y),0}function bb_graphics_DrawImageRect(t,e,_,i,A,n,s,r){var a=t.m_frames[r];return bb_graphics_context.p_Validate(),bb_graphics_renderDevice.DrawSurface2(t.m_surface,-t.m_tx+e,-t.m_ty+_,i+a.m_x,A+a.m_y,n,s),0}function bb_graphics_DrawImageRect2(t,e,_,i,A,n,s,r,a,m,o){var h=t.m_frames[o];return bb_graphics_PushMatrix(),bb_graphics_Translate(e,_),bb_graphics_Rotate(r),bb_graphics_Scale(a,m),bb_graphics_Translate(-t.m_tx,-t.m_ty),bb_graphics_context.p_Validate(),bb_graphics_renderDevice.DrawSurface2(t.m_surface,0,0,i+h.m_x,A+h.m_y,n,s),bb_graphics_PopMatrix(),0}function c_ftMapTile(){Object.call(this),this.m_xOff=0,this.m_yOff=0,this.m_tileID=0}function bb_graphics_DrawRect(t,e,_,i){return bb_graphics_context.p_Validate(),bb_graphics_renderDevice.DrawRect(t,e,_,i),0}function bb_audio_ChannelState(t){return bb_audio_device.ChannelState(t)}function bb_audio_PlaySound(t,e,_){return null!=t&&null!=t.m_sample&&bb_audio_device.PlaySample(t.m_sample,e,_),0}function bb_audio_SetChannelVolume(t,e){return bb_audio_device.SetVolume(t,e),0}function bb_audio_SetChannelPan(t,e){return bb_audio_device.SetPan(t,e),0}function bb_audio_SetChannelRate(t,e){return bb_audio_device.SetRate(t,e),0}function bb_audio_PlayMusic(t,e){return bb_audio_device.PlayMusic(bb_data_FixDataPath(t),e)}function bb_audio_SetMusicVolume(t){return bb_audio_device.SetMusicVolume(t),0}function bb_input_KeyDown(t){return bb_input_device.p_KeyDown(t)?1:0}function bb_app_SaveState(t){return bb_app__game.SaveState(t)}function bbInit(){bb_app__app=null,bb_app__delegate=null,bb_app__game=BBGame.Game(),bb_RockSmash_g=null,bb_graphics_device=null,bb_graphics_context=c_GraphicsContext.m_new.call(new c_GraphicsContext),c_Image.m_DefaultFlags=0,bb_audio_device=null,bb_input_device=null,bb_graphics_renderDevice=null,bb_app__updateRate=0,bb_random_Seed=1234}var RESIZEABLE_CANVAS=!1;window.onload=function(){RESIZEABLE_CANVAS&&(window.onresize=function(){var t=document.getElementById("GameCanvas"),e=document.body.clientWidth,_=window.innerHeight;t.width=e,t.height=_},window.onresize(null)),BBMonkeyGame.Main(document.getElementById("GameCanvas"))},CFG_BINARY_FILES="*.bin|*.dat",CFG_BRL_GAMETARGET_IMPLEMENTED="1",CFG_BRL_THREAD_IMPLEMENTED="1",CFG_CD="",CFG_CONFIG="release",CFG_HOST="winnt",CFG_IMAGE_FILES="*.png|*.jpg",CFG_LANG="js",CFG_MODPATH=".;C:/MonkeyPro70g/RockSmash;C:/MonkeyPro70g/modules;C:/MonkeyPro70g/modules_ext;C:/MonkeyPro70g/targets/html5/modules",CFG_MOJO_AUTO_SUSPEND_ENABLED="0",CFG_MONKEYDIR="",CFG_MUSIC_FILES="*.wav|*.ogg|*.mp3|*.m4a",CFG_OPENGL_GLES20_ENABLED="0",CFG_SAFEMODE="0",CFG_SOUND_FILES="*.wav|*.ogg|*.mp3|*.m4a",CFG_TARGET="html5",CFG_TEXT_FILES="*.txt|*.xml|*.json",CFG_TRANSDIR="";var META_DATA="[cc_font.png];type=image/png;width=256;height=128;\n[cctiles.png];type=image/png;width=128;height=128;\n[mojo_font.png];type=image/png;width=864;height=13;\n",D2R=.017453292519943295,R2D=57.29577951308232,err_info="",err_stack=[],dbg_index=0;ThrowableObject.prototype.toString=function(){return"Uncaught Monkey Exception"},BBGameEvent.KeyDown=1,BBGameEvent.KeyUp=2,BBGameEvent.KeyChar=3,BBGameEvent.MouseDown=4,BBGameEvent.MouseUp=5,BBGameEvent.MouseMove=6,BBGameEvent.TouchDown=7,BBGameEvent.TouchUp=8,BBGameEvent.TouchMove=9,BBGameEvent.MotionAccel=10,BBGameDelegate.prototype.StartGame=function(){},BBGameDelegate.prototype.SuspendGame=function(){},BBGameDelegate.prototype.ResumeGame=function(){},BBGameDelegate.prototype.UpdateGame=function(){},BBGameDelegate.prototype.RenderGame=function(){},BBGameDelegate.prototype.KeyEvent=function(){},BBGameDelegate.prototype.MouseEvent=function(){},BBGameDelegate.prototype.TouchEvent=function(){},BBGameDelegate.prototype.MotionEvent=function(){},BBGameDelegate.prototype.DiscardGraphics=function(){},BBGame.Game=function(){return BBGame._game},BBGame.prototype.SetDelegate=function(t){this._delegate=t},BBGame.prototype.Delegate=function(){return this._delegate},BBGame.prototype.SetUpdateRate=function(t){this._updateRate=t},BBGame.prototype.SetKeyboardEnabled=function(t){this._keyboardEnabled=t},BBGame.prototype.Started=function(){return this._started},BBGame.prototype.Suspended=function(){return this._suspended},BBGame.prototype.Millisecs=function(){return Date.now()-this._startms},BBGame.prototype.GetDate=function(t){var e=t.length;if(e>0){var _=new Date;t[0]=_.getFullYear(),e>1&&(t[1]=_.getMonth()+1,e>2&&(t[2]=_.getDate(),e>3&&(t[3]=_.getHours(),e>4&&(t[4]=_.getMinutes(),e>5&&(t[5]=_.getSeconds(),e>6&&(t[6]=_.getMilliseconds()))))))}},BBGame.prototype.SaveState=function(t){return localStorage.setItem("monkeystate@"+document.URL,t),1},BBGame.prototype.LoadState=function(){var t=localStorage.getItem("monkeystate@"+document.URL);return t?t:""},BBGame.prototype.LoadString=function(t){var e=new XMLHttpRequest;return e.open("GET",this.PathToUrl(t),!1),e.send(null),200==e.status||0==e.status?e.responseText:""},BBGame.prototype.PollJoystick=function(){return!1},BBGame.prototype.OpenUrl=function(t){window.location=t},BBGame.prototype.SetMouseVisible=function(t){this._canvas.style.cursor=t?"default":"url('data:image/cur;base64,AAACAAEAICAAAAAAAACoEAAAFgAAACgAAAAgAAAAQAAAAAEAIAAAAAAAgBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA55ZXBgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOeWVxAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADnllcGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9////////////////////+////////f/////////8%3D'), auto"
},BBGame.prototype.PathToFilePath=function(){return""},BBGame.prototype.PathToUrl=function(t){return t},BBGame.prototype.LoadData=function(t){var e=new XMLHttpRequest;if(e.open("GET",this.PathToUrl(t),!1),e.overrideMimeType&&e.overrideMimeType("text/plain; charset=x-user-defined"),e.send(null),200!=e.status&&0!=e.status)return null;for(var _=e.responseText,i=new ArrayBuffer(_.length),A=new Int8Array(i),n=0;n<_.length;++n)A[n]=_.charCodeAt(n);return i},BBGame.prototype.Die=function(t){if(this._delegate=new BBGameDelegate,t.toString())throw this._debugExs&&(print("Monkey Runtime Error : "+t.toString()),print(stackTrace())),t},BBGame.prototype.StartGame=function(){if(!this._started)if(this._started=!0,this._debugExs)try{this._delegate.StartGame()}catch(t){this.Die(t)}else this._delegate.StartGame()},BBGame.prototype.SuspendGame=function(){if(this._started&&!this._suspended)if(this._suspended=!0,this._debugExs)try{this._delegate.SuspendGame()}catch(t){this.Die(t)}else this._delegate.SuspendGame()},BBGame.prototype.ResumeGame=function(){if(this._started&&this._suspended)if(this._suspended=!1,this._debugExs)try{this._delegate.ResumeGame()}catch(t){this.Die(t)}else this._delegate.ResumeGame()},BBGame.prototype.UpdateGame=function(){if(this._started&&!this._suspended)if(this._debugExs)try{this._delegate.UpdateGame()}catch(t){this.Die(t)}else this._delegate.UpdateGame()},BBGame.prototype.RenderGame=function(){if(this._started)if(this._debugExs)try{this._delegate.RenderGame()}catch(t){this.Die(t)}else this._delegate.RenderGame()},BBGame.prototype.KeyEvent=function(t,e){if(this._started)if(this._debugExs)try{this._delegate.KeyEvent(t,e)}catch(_){this.Die(_)}else this._delegate.KeyEvent(t,e)},BBGame.prototype.MouseEvent=function(t,e,_,i){if(this._started)if(this._debugExs)try{this._delegate.MouseEvent(t,e,_,i)}catch(A){this.Die(A)}else this._delegate.MouseEvent(t,e,_,i)},BBGame.prototype.TouchEvent=function(t,e,_,i){if(this._started)if(this._debugExs)try{this._delegate.TouchEvent(t,e,_,i)}catch(A){this.Die(A)}else this._delegate.TouchEvent(t,e,_,i)},BBGame.prototype.MotionEvent=function(t,e,_,i,A){if(this._started)if(this._debugExs)try{this._delegate.MotionEvent(t,e,_,i,A)}catch(n){this.Die(n)}else this._delegate.MotionEvent(t,e,_,i,A)},BBGame.prototype.DiscardGraphics=function(){if(this._started)if(this._debugExs)try{this._delegate.DiscardGraphics()}catch(t){this.Die(t)}else this._delegate.DiscardGraphics()},BBHtml5Game.prototype=extend_class(BBGame),BBHtml5Game.Html5Game=function(){return BBHtml5Game._game},BBHtml5Game.prototype.ValidateUpdateTimer=function(){function t(){if(A==e._timerSeq){var n;for(n=0;4>n;++n){if(i+=_,e.UpdateGame(),A!=e._timerSeq)return;if(i-Date.now()>0)break}if(e.RenderGame(),A==e._timerSeq)if(4==n)i=Date.now(),setTimeout(t,0);else{var s=i-Date.now();setTimeout(t,s>0?s:0)}}}if(++this._timerSeq,this._updateRate&&!this._suspended){var e=this,_=1e3/this._updateRate,i=Date.now()+_,A=e._timerSeq;setTimeout(t,_)}},BBHtml5Game.prototype.SetUpdateRate=function(t){BBGame.prototype.SetUpdateRate.call(this,t),this.ValidateUpdateTimer()},BBHtml5Game.prototype.GetMetaData=function(t,e){if(0!=t.indexOf("monkey://data/"))return"";t=t.slice(14);var _=META_DATA.indexOf("["+t+"]");if(-1==_)return"";_+=t.length+2;var i=META_DATA.indexOf("\n",_);return-1==i&&(i=META_DATA.length),_=META_DATA.indexOf(";"+e+"=",_),-1==_||_>=i?"":(_+=e.length+2,i=META_DATA.indexOf(";",_),-1==i?"":META_DATA.slice(_,i))},BBHtml5Game.prototype.PathToUrl=function(t){return 0!=t.indexOf("monkey:")?t:0==t.indexOf("monkey://data/")?"data/"+t.slice(14):""},BBHtml5Game.prototype.GetLoading=function(){return this._loading},BBHtml5Game.prototype.IncLoading=function(){return++this._loading,this._loading},BBHtml5Game.prototype.DecLoading=function(){return--this._loading,this._loading},BBHtml5Game.prototype.GetCanvas=function(){return this._canvas},BBHtml5Game.prototype.GetWebGL=function(){return this._gl},BBHtml5Game.prototype.UpdateGame=function(){this._loading||BBGame.prototype.UpdateGame.call(this)},BBHtml5Game.prototype.SuspendGame=function(){BBGame.prototype.SuspendGame.call(this),this.ValidateUpdateTimer()},BBHtml5Game.prototype.ResumeGame=function(){BBGame.prototype.ResumeGame.call(this),this.ValidateUpdateTimer()},BBHtml5Game.prototype.Run=function(){function t(t){t.stopPropagation?(t.stopPropagation(),t.preventDefault()):(t.cancelBubble=!0,t.returnValue=!1)}function e(t){switch(t){case 8:case 9:case 13:case 27:case 32:return t;case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 45:return 65536|t;case 46:return 127}return 0}function _(t){for(var e=t.clientX+document.body.scrollLeft,_=a;_;)e-=_.offsetLeft,_=_.offsetParent;return e}function A(t){for(var e=t.clientY+document.body.scrollTop,_=a;_;)e-=_.offsetTop,_=_.offsetParent;return e}function n(t){for(var e=t.pageX,_=a;_;)e-=_.offsetLeft,_=_.offsetParent;return e}function s(t){for(var e=t.pageY,_=a;_;)e-=_.offsetTop,_=_.offsetParent;return e}var r=this,a=r._canvas,m=new Array(32);for(i=0;32>i;++i)m[i]=-1;a.onkeydown=function(_){r.KeyEvent(BBGameEvent.KeyDown,_.keyCode);var i=e(_.keyCode);i&&r.KeyEvent(BBGameEvent.KeyChar,i),(_.keyCode<48||_.keyCode>111&&_.keyCode<122)&&t(_)},a.onkeyup=function(t){r.KeyEvent(BBGameEvent.KeyUp,t.keyCode)},a.onkeypress=function(t){t.charCode?r.KeyEvent(BBGameEvent.KeyChar,t.charCode):t.which&&r.KeyEvent(BBGameEvent.KeyChar,t.which)},a.onmousedown=function(e){switch(e.button){case 0:r.MouseEvent(BBGameEvent.MouseDown,0,_(e),A(e));break;case 1:r.MouseEvent(BBGameEvent.MouseDown,2,_(e),A(e));break;case 2:r.MouseEvent(BBGameEvent.MouseDown,1,_(e),A(e))}t(e)},a.onmouseup=function(e){switch(e.button){case 0:r.MouseEvent(BBGameEvent.MouseUp,0,_(e),A(e));break;case 1:r.MouseEvent(BBGameEvent.MouseUp,2,_(e),A(e));break;case 2:r.MouseEvent(BBGameEvent.MouseUp,1,_(e),A(e))}t(e)},a.onmousemove=function(e){r.MouseEvent(BBGameEvent.MouseMove,-1,_(e),A(e)),t(e)},a.onmouseout=function(e){r.MouseEvent(BBGameEvent.MouseUp,0,_(e),A(e)),r.MouseEvent(BBGameEvent.MouseUp,1,_(e),A(e)),r.MouseEvent(BBGameEvent.MouseUp,2,_(e),A(e)),t(e)},a.ontouchstart=function(e){for(var _=0;_<e.changedTouches.length;++_)for(var i=e.changedTouches[_],A=0;32>A;++A)if(-1==m[A]){m[A]=i.identifier,r.TouchEvent(BBGameEvent.TouchDown,A,n(i),s(i));break}t(e)},a.ontouchmove=function(e){for(var _=0;_<e.changedTouches.length;++_)for(var i=e.changedTouches[_],A=0;32>A;++A)if(m[A]==i.identifier){r.TouchEvent(BBGameEvent.TouchMove,A,n(i),s(i));break}t(e)},a.ontouchend=function(e){for(var _=0;_<e.changedTouches.length;++_)for(var i=e.changedTouches[_],A=0;32>A;++A)if(m[A]==i.identifier){m[A]=-1,r.TouchEvent(BBGameEvent.TouchUp,A,n(i),s(i));break}t(e)},window.ondevicemotion=function(e){var _,i,A=e.accelerationIncludingGravity.x/9.81,n=e.accelerationIncludingGravity.y/9.81,s=e.accelerationIncludingGravity.z/9.81;switch(window.orientation){case 0:_=+A,i=-n;break;case 180:_=-A,i=+n;break;case 90:_=-n,i=-A;break;case-90:_=+n,i=+A}r.MotionEvent(BBGameEvent.MotionAccel,0,_,i,s),t(e)},a.onfocus=function(){"1"==CFG_MOJO_AUTO_SUSPEND_ENABLED&&r.ResumeGame()},a.onblur=function(){"1"==CFG_MOJO_AUTO_SUSPEND_ENABLED&&r.SuspendGame()},a.focus(),r.StartGame(),r.RenderGame()},BBMonkeyGame.prototype=extend_class(BBHtml5Game),BBMonkeyGame.Main=function(t){var e=new BBMonkeyGame(t);try{bbInit(),bbMain()}catch(_){return e.Die(_),void 0}e.Delegate()&&e.Run()},gxtkGraphics.prototype.BeginRender=function(){return this.width=this.canvas.width,this.height=this.canvas.height,this.gc?(this.gc.save(),this.game.GetLoading()?2:1):0},gxtkGraphics.prototype.EndRender=function(){this.gc&&this.gc.restore()},gxtkGraphics.prototype.Width=function(){return this.width},gxtkGraphics.prototype.Height=function(){return this.height},gxtkGraphics.prototype.LoadSurface=function(t){function e(){_.DecLoading()}var _=this.game,i=_.GetMetaData(t,"type");if(0!=i.indexOf("image/"))return null;_.IncLoading();var A=new Image;return A.onload=e,A.meta_width=parseInt(_.GetMetaData(t,"width")),A.meta_height=parseInt(_.GetMetaData(t,"height")),A.src=_.PathToUrl(t),new gxtkSurface(A,this)},gxtkGraphics.prototype.CreateSurface=function(t,e){var _=document.createElement("canvas");_.width=t,_.height=e,_.meta_width=t,_.meta_height=e,_.complete=!0;var i=new gxtkSurface(_,this);return i.gc=_.getContext("2d"),i},gxtkGraphics.prototype.SetAlpha=function(t){this.alpha=t,this.gc.globalAlpha=t},gxtkGraphics.prototype.SetColor=function(t,e,_){this.r=t,this.g=e,this.b=_,this.white=255==t&&255==e&&255==_,this.color="rgb("+(0|t)+","+(0|e)+","+(0|_)+")",this.gc.fillStyle=this.color,this.gc.strokeStyle=this.color},gxtkGraphics.prototype.SetBlend=function(t){switch(t){case 1:this.blend="lighter";break;default:this.blend="source-over"}this.gc.globalCompositeOperation=this.blend},gxtkGraphics.prototype.SetScissor=function(t,e,_,i){this.scissorX=t,this.scissorY=e,this.scissorWidth=_,this.scissorHeight=i,this.clipped=0!=t||0!=e||_!=this.canvas.width||i!=this.canvas.height,this.gc.restore(),this.gc.save(),this.clipped&&(this.gc.beginPath(),this.gc.rect(t,e,_,i),this.gc.clip(),this.gc.closePath()),this.gc.fillStyle=this.color,this.gc.strokeStyle=this.color,this.gc.globalAlpha=this.alpha,this.gc.globalCompositeOperation=this.blend,this.tformed&&this.gc.setTransform(this.ix,this.iy,this.jx,this.jy,this.tx,this.ty)},gxtkGraphics.prototype.SetMatrix=function(t,e,_,i,A,n){this.ix=t,this.iy=e,this.jx=_,this.jy=i,this.tx=A,this.ty=n,this.gc.setTransform(t,e,_,i,A,n),this.tformed=1!=t||0!=e||0!=_||1!=i||0!=A||0!=n},gxtkGraphics.prototype.Cls=function(t,e,_){this.tformed&&this.gc.setTransform(1,0,0,1,0,0),this.gc.fillStyle="rgb("+(0|t)+","+(0|e)+","+(0|_)+")",this.gc.globalAlpha=1,this.gc.globalCompositeOperation="source-over",this.gc.fillRect(0,0,this.canvas.width,this.canvas.height),this.gc.fillStyle=this.color,this.gc.globalAlpha=this.alpha,this.gc.globalCompositeOperation=this.blend,this.tformed&&this.gc.setTransform(this.ix,this.iy,this.jx,this.jy,this.tx,this.ty)},gxtkGraphics.prototype.DrawPoint=function(t,e){if(this.tformed){var _=t;t=_*this.ix+e*this.jx+this.tx,e=_*this.iy+e*this.jy+this.ty,this.gc.setTransform(1,0,0,1,0,0),this.gc.fillRect(t,e,1,1),this.gc.setTransform(this.ix,this.iy,this.jx,this.jy,this.tx,this.ty)}else this.gc.fillRect(t,e,1,1)},gxtkGraphics.prototype.DrawRect=function(t,e,_,i){0>_&&(t+=_,_=-_),0>i&&(e+=i,i=-i),0>=_||0>=i||this.gc.fillRect(t,e,_,i)},gxtkGraphics.prototype.DrawLine=function(t,e,_,i){if(this.tformed){var A=t*this.ix+e*this.jx+this.tx,n=t*this.iy+e*this.jy+this.ty,s=_*this.ix+i*this.jx+this.tx,r=_*this.iy+i*this.jy+this.ty;this.gc.setTransform(1,0,0,1,0,0),this.gc.beginPath(),this.gc.moveTo(A,n),this.gc.lineTo(s,r),this.gc.stroke(),this.gc.closePath(),this.gc.setTransform(this.ix,this.iy,this.jx,this.jy,this.tx,this.ty)}else this.gc.beginPath(),this.gc.moveTo(t,e),this.gc.lineTo(_,i),this.gc.stroke(),this.gc.closePath()},gxtkGraphics.prototype.DrawOval=function(t,e,_,i){if(0>_&&(t+=_,_=-_),0>i&&(e+=i,i=-i),!(0>=_||0>=i)){var A=_/2,n=i/2;this.gc.save(),this.gc.translate(t+A,e+n),this.gc.scale(A,n),this.gc.beginPath(),this.gc.arc(0,0,1,0,2*Math.PI,!1),this.gc.fill(),this.gc.closePath(),this.gc.restore()}},gxtkGraphics.prototype.DrawPoly=function(t){if(!(t.length<2)){this.gc.beginPath(),this.gc.moveTo(t[0],t[1]);for(var e=2;e<t.length;e+=2)this.gc.lineTo(t[e],t[e+1]);this.gc.fill(),this.gc.closePath()}},gxtkGraphics.prototype.DrawPoly2=function(t){if(!(t.length<4)){this.gc.beginPath(),this.gc.moveTo(t[0],t[1]);for(var e=4;e<t.length;e+=4)this.gc.lineTo(t[e],t[e+1]);this.gc.fill(),this.gc.closePath()}},gxtkGraphics.prototype.DrawSurface=function(t,e,_){return t.image.complete?this.white?(this.gc.drawImage(t.image,e,_),void 0):(this.DrawImageTinted(t.image,e,_,0,0,t.swidth,t.sheight),void 0):void 0},gxtkGraphics.prototype.DrawSurface2=function(t,e,_,i,A,n,s){return!t.image.complete||(0>n&&(i+=n,n=-n),0>s&&(A+=s,s=-s),0>=n||0>=s)?void 0:this.white?(this.gc.drawImage(t.image,i,A,n,s,e,_,n,s),void 0):(this.DrawImageTinted(t.image,e,_,i,A,n,s),void 0)},gxtkGraphics.prototype.DrawImageTinted=function(t,e,_,i,A,n,s){this.tmpCanvas||(this.tmpCanvas=document.createElement("canvas")),(n>this.tmpCanvas.width||s>this.tmpCanvas.height)&&(this.tmpCanvas.width=Math.max(n,this.tmpCanvas.width),this.tmpCanvas.height=Math.max(s,this.tmpCanvas.height));var r=this.tmpCanvas.getContext("2d");r.globalCompositeOperation="copy",r.drawImage(t,i,A,n,s,0,0,n,s);var a,m=r.getImageData(0,0,n,s),o=m.data,h=4*n*s;for(a=0;h>a;a+=4)o[a]=o[a]*this.r/255,o[a+1]=o[a+1]*this.g/255,o[a+2]=o[a+2]*this.b/255;r.putImageData(m,0,0),this.gc.drawImage(this.tmpCanvas,0,0,n,s,e,_,n,s)},gxtkGraphics.prototype.ReadPixels=function(t,e,_,i,A,n,s){var r,a,m=this.gc.getImageData(e,_,i,A),o=m.data,h=0,c=n;for(a=0;A>a;++a){for(r=0;i>r;++r)t[c++]=o[h+3]<<24|o[h]<<16|o[h+1]<<8|o[h+2],h+=4;c+=s-i}},gxtkGraphics.prototype.WritePixels2=function(t,e,_,i,A,n,s,r){if(!t.gc){if(!t.image.complete)return;var a=document.createElement("canvas");a.width=t.swidth,a.height=t.sheight,t.gc=a.getContext("2d"),t.gc.globalCompositeOperation="copy",t.gc.drawImage(t.image,0,0),t.image=a}var m,o,h,c=t.gc.createImageData(A,n),p=c.data,l=0,u=s;for(o=0;n>o;++o){for(m=0;A>m;++m)h=e[u++],p[l]=255&h>>16,p[l+1]=255&h>>8,p[l+2]=255&h,p[l+3]=255&h>>24,l+=4;u+=r-A}t.gc.putImageData(c,_,i)},gxtkSurface.prototype.Discard=function(){this.image&&(this.image=null)},gxtkSurface.prototype.Width=function(){return this.swidth},gxtkSurface.prototype.Height=function(){return this.sheight},gxtkSurface.prototype.Loaded=function(){return this.image.complete},gxtkSurface.prototype.OnUnsafeLoadComplete=function(){return!0},gxtkAudio.prototype.Suspend=function(){var t;for(t=0;33>t;++t){var e=this.channels[t];1==e.state&&e.audio.pause()}},gxtkAudio.prototype.Resume=function(){var t;for(t=0;33>t;++t){var e=this.channels[t];1==e.state&&e.audio.play()}},gxtkAudio.prototype.LoadSample=function(t){if(!this.okay)return null;var e=new Audio(this.game.PathToUrl(t));return e?new gxtkSample(e):null},gxtkAudio.prototype.PlaySample=function(t,e,_){if(this.okay){var i=this.channels[e];i.state>0&&(i.audio.pause(),i.state=0);for(var A=0;33>A;++A){var n=this.channels[A];1==n.state&&n.audio.ended&&!n.audio.loop&&(i.state=0),0==n.state&&n.sample&&(n.sample.FreeAudio(n.audio),n.sample=null,n.audio=null)}var s=t.AllocAudio();s&&(s.loop=0!=(1&_),s.volume=i.volume,s.play(),i.sample=t,i.audio=s,i.flags=_,i.state=1)}},gxtkAudio.prototype.StopChannel=function(t){var e=this.channels[t];e.state>0&&(e.audio.pause(),e.state=0)},gxtkAudio.prototype.PauseChannel=function(t){var e=this.channels[t];1==e.state&&(e.audio.ended&&!e.audio.loop?e.state=0:(e.audio.pause(),e.state=2))},gxtkAudio.prototype.ResumeChannel=function(t){var e=this.channels[t];2==e.state&&(e.audio.play(),e.state=1)},gxtkAudio.prototype.ChannelState=function(t){var e=this.channels[t];return 1==e.state&&e.audio.ended&&!e.audio.loop&&(e.state=0),e.state},gxtkAudio.prototype.SetVolume=function(t,e){var _=this.channels[t];_.state>0&&(_.audio.volume=e),_.volume=e},gxtkAudio.prototype.SetPan=function(t,e){var _=this.channels[t];_.pan=e},gxtkAudio.prototype.SetRate=function(t,e){var _=this.channels[t];_.rate=e},gxtkAudio.prototype.PlayMusic=function(t,e){this.StopMusic(),this.music=this.LoadSample(t),this.music&&this.PlaySample(this.music,32,e)},gxtkAudio.prototype.StopMusic=function(){this.StopChannel(32),this.music&&(this.music.Discard(),this.music=null)},gxtkAudio.prototype.PauseMusic=function(){this.PauseChannel(32)},gxtkAudio.prototype.ResumeMusic=function(){this.ResumeChannel(32)},gxtkAudio.prototype.MusicState=function(){return this.ChannelState(32)},gxtkAudio.prototype.SetMusicVolume=function(t){this.SetVolume(32,t)},gxtkSample.prototype.FreeAudio=function(t){this.free.push(t)},gxtkSample.prototype.AllocAudio=function(){for(var t;this.free.length;){t=this.free.pop();try{return t.currentTime=0,t}catch(e){print("AUDIO ERROR1!")}}return 8==this.insts.length?null:(t=new Audio(this.audio.src),t.addEventListener("ended",function(){if(this.loop)try{this.currentTime=0,this.play()}catch(t){print("AUDIO ERROR2!")}},!1),this.insts.push(t),t)},gxtkSample.prototype.Discard=function(){},BBThread.prototype.Start=function(){this.running=!0,this.Run__UNSAFE__()},BBThread.prototype.IsRunning=function(){return this.running},BBThread.prototype.Run__UNSAFE__=function(){this.running=!1},BBAsyncImageLoaderThread.prototype=extend_class(BBThread),BBAsyncImageLoaderThread.prototype.Start=function(){var t=this,e=new Image;e.onload=function(){e.meta_width=e.width,e.meta_height=e.height,t._surface=new gxtkSurface(e,t._device),t.running=!1},e.onerror=function(){t._surface=null,t.running=!1},t.running=!0,e.src=BBGame.Game().PathToUrl(t._path)},BBAsyncSoundLoaderThread.prototype=extend_class(BBThread),BBAsyncSoundLoaderThread.prototype.Start=function(){this._sample=this._device.LoadSample(this._path)};var fantomengine=new Object;fantomengine.DeviceName=function(){return""},fantomengine.Hardware=function(){return""},fantomengine.Product=function(){return""},fantomengine.Serial=function(){return""},fantomengine.User=function(){return""},fantomengine.GetBrowserName=function(){var t="";return t=navigator.userAgent.search("MSIE")>=0?"MS Internet Explorer":navigator.userAgent.search("Chrome")>=0?"Google Chrome":navigator.userAgent.search("Firefox")>=0?"Mozilla Firefox":navigator.userAgent.search("Safari")>=0&&navigator.userAgent.search("Chrome")<0?"Apple Safari":navigator.userAgent.search("Opera")>=0?"Opera":"Other"},fantomengine.GetBrowserVersion=function(){var t="";if(navigator.userAgent.search("MSIE")>=0){var e=navigator.userAgent.search("MSIE")+5,_=navigator.userAgent.search("; Windows"),i=navigator.userAgent.substring(e,_);t=i}else if(navigator.userAgent.search("Chrome")>=0){var e=navigator.userAgent.search("Chrome")+7,_=navigator.userAgent.search(" Safari"),i=navigator.userAgent.substring(e,_);t=i}else if(navigator.userAgent.search("Firefox")>=0){var e=navigator.userAgent.search("Firefox")+8,i=navigator.userAgent.substring(e);t=i}else if(navigator.userAgent.search("Safari")>=0&&navigator.userAgent.search("Chrome")<0){var e=navigator.userAgent.search("Version")+8,_=navigator.userAgent.search(" Safari"),i=navigator.userAgent.substring(e,_);t=i}else if(navigator.userAgent.search("Opera")>=0){var e=navigator.userAgent.search("Version")+8,i=navigator.userAgent.substring(e);t=i}else t="";return t},fantomengine.GetBrowserPlatform=function(){return navigator.platform},fantomengine.MaximizeCanvas=function(){var t=document.getElementById("GameCanvas");t&&(t.width=window.innerWidth,t.height=window.innerHeight,t.ontouchmove=function(t){t.preventDefault()});var e=document.getElementById("GameConsole");e&&(e.style.width="0px",e.style.height="0px")},c_App.m_new=function(){return null!=bb_app__app&&error("App has already been created"),bb_app__app=this,bb_app__delegate=c_GameDelegate.m_new.call(new c_GameDelegate),bb_app__game.SetDelegate(bb_app__delegate),this},c_App.prototype.p_OnCreate=function(){return 0},c_App.prototype.p_OnSuspend=function(){return 0},c_App.prototype.p_OnResume=function(){return 0},c_App.prototype.p_OnUpdate=function(){return 0},c_App.prototype.p_OnLoading=function(){return 0},c_App.prototype.p_OnRender=function(){return 0},c_App.prototype.p_OnClose=function(){return bb_app_EndApp(),0},c_App.prototype.p_OnBack=function(){return this.p_OnClose(),0},c_game.prototype=extend_class(c_App),c_game.m_new=function(){return c_App.m_new.call(this),this},c_game.prototype.p_CreateLayers=function(){return this.m_layerBackground=this.m_eng.p_CreateLayer(null),this.m_layerGame=this.m_eng.p_CreateLayer(null),this.m_layerFX=this.m_eng.p_CreateLayer(null),this.m_layerUI=this.m_eng.p_CreateLayer(null),this.m_layerTitle=this.m_eng.p_CreateLayer(null),this.m_layerScore=this.m_eng.p_CreateLayer(null),0},c_game.prototype.p_CreateStars=function(t){for(var e=1;t>=e;e+=1){var _=this.m_eng.p_CreateImage3(this.m_atlas,16,112,16,16,bb_random_Rnd2(0,this.m_eng.m_canvasWidth),bb_random_Rnd2(0,this.m_eng.m_canvasHeight),null);_.p_SetScale(bb_random_Rnd2(1,3)/10,0),_.p_SetAngle(bb_random_Rnd2(0,359),0),_.p_SetSpin(5,0),_.p_SetLayer(this.m_layerBackground)}return 0},c_game.prototype.p_CreatePlayer=function(){return this.m_player=this.m_eng.p_CreateImage3(this.m_atlas,0,0,32,32,0,0,null),this.m_player.p_SetFriction(.2,0),this.m_player.p_SetMaxSpeed(20),this.m_player.p_SetWrapScreen(!0),this.m_player.p_SetLayer(this.m_layerGame),this.m_player.p_SetColGroup(3),this.m_player.p_SetColWith2(2,1),this.m_player.p_SetColWith2(10,1),this.m_player.p_SetRadius(12,0),this.m_player.p_SetActive(!1),this.m_shield=this.m_eng.p_CreateImage3(this.m_atlas,32,96,32,32,0,0,null),this.m_shield.p_SetScale(2,0),this.m_shield.p_SetSpin(15,0),this.m_shield.p_SetLayer(this.m_layerGame),this.m_shield.p_SetParent(this.m_player),this.m_shield.p_SetColGroup(6),this.m_shield.p_SetColWith2(2,1),this.m_shield.p_SetRadius(13,0),this.m_shield.p_SetActive(!1),0},c_game.prototype.p_LoadSounds=function(){return this.m_sndExplo=this.m_eng.p_LoadSound("explosion",!1),this.m_sndShot=this.m_eng.p_LoadSound("shoot1",!1),0},c_game.prototype.p_CreateInfoText=function(){return this.m_txtScore=this.m_eng.p_CreateText(this.m_font1,"Score:    "+String(this.m_score),0,0,0),this.m_txtScore.p_SetLayer(this.m_layerUI),this.m_txtLevel=this.m_eng.p_CreateText(this.m_font1,"Level:    "+String(this.m_levelNumber),this.m_eng.m_canvasWidth-5,0,2),this.m_txtLevel.p_SetLayer(this.m_layerUI),this.m_txtComets=this.m_eng.p_CreateText(this.m_font1,"Comets:    "+String(this.m_cometCount),0,this.m_eng.m_canvasHeight-this.m_font1.m_lineHeight,0),this.m_txtComets.p_SetLayer(this.m_layerUI),this.m_txtLives=this.m_eng.p_CreateText(this.m_font1,"Lives:    "+String(this.m_lives),this.m_eng.m_canvasWidth-5,this.m_eng.m_canvasHeight-this.m_font1.m_lineHeight,2),this.m_txtLives.p_SetLayer(this.m_layerUI),0},c_game.prototype.p_CreateTitleScreen=function(){var t=this.m_eng.p_CreateText(this.m_font1,"RockSmash",this.m_eng.m_canvasWidth/2,this.m_eng.m_canvasHeight/2-40,1);t.p_SetLayer(this.m_layerTitle);var e=this.m_eng.p_CreateText(this.m_font1,"*** Press 'P' to play ***",this.m_eng.m_canvasWidth/2,this.m_eng.m_canvasHeight/2+10,1);e.p_SetLayer(this.m_layerTitle);var _=this.m_eng.p_CreateText(this.m_font1,"*** Press 'H' to see the highscore list ***",this.m_eng.m_canvasWidth/2,this.m_eng.m_canvasHeight/2+40,1);return _.p_SetLayer(this.m_layerTitle),0},c_game.prototype.p_CreateHighScoreList=function(){var t=this.m_eng.p_CreateText(this.m_font1,"H I G H S C O R E S",this.m_eng.m_canvasWidth/2,70,1);t.p_SetLayer(this.m_layerScore);for(var e=1;10>=e;e+=1){var _=this.m_eng.p_CreateText(this.m_font1,"#"+String(e),this.m_eng.m_canvasWidth/4+50,80+this.m_eng.m_canvasHeight/20*e,0);_.p_SetLayer(this.m_layerScore),this.m_txtHighScores[e-1]=this.m_eng.p_CreateText(this.m_font1,"0000000",3*(this.m_eng.m_canvasWidth/4)-50,80+this.m_eng.m_canvasHeight/20*e,2),this.m_txtHighScores[e-1].p_SetLayer(this.m_layerScore)}return this.m_layerScore.p_SetActive(!1),0},c_game.prototype.p_OnCreate=function(){return bb_app_SetUpdateRate(60),this.m_eng=c_engine.m_new.call(new c_engine),this.m_atlas=bb_graphics_LoadImage("cctiles.png",1,c_Image.m_DefaultFlags),this.p_CreateLayers(),this.p_CreateStars(60),this.p_CreatePlayer(),this.p_LoadSounds(),this.m_font1=this.m_eng.p_LoadFont("cc_font"),this.p_CreateInfoText(),this.p_CreateTitleScreen(),this.p_CreateHighScoreList(),0},c_game.prototype.p_PauseGame=function(){return this.m_gameMode=5,0},c_game.prototype.p_UpdateGameTime=function(){return 2==this.m_gameMode?(this.m_deltaTime=bb_app_Millisecs()-this.m_lastTime,this.m_lastTime+=this.m_deltaTime,this.m_deltaTime):0},c_game.prototype.p_UpdateInfoText=function(){return this.m_txtScore.p_SetText("Score:   "+String(this.m_score)),this.m_txtComets.p_SetText("Comets:  "+String(this.m_cometCount)),this.m_txtLevel.p_SetText("Level:   "+String(this.m_levelNumber)),this.m_txtLives.p_SetText("Lives:   "+String(this.m_lives)),0},c_game.prototype.p_ActivateShield=function(){return this.m_eng.p_CreateObjTimer(bb_RockSmash_g.m_shield,3,4500,0),bb_RockSmash_g.m_player.p_SetColGroup(0),bb_RockSmash_g.m_shield.p_SetActive(!0),0},c_game.prototype.p_CreateComet=function(t,e,_,i,A){var n=null;if(1==t&&(n=this.m_eng.p_CreateImage3(this.m_atlas,0,32,16,16,e,_,null),n.p_SetRadius(4,0)),2==t&&(n=this.m_eng.p_CreateImage3(this.m_atlas,32,0,32,32,e,_,null),n.p_SetRadius(12,0)),3==t){var s=0|bb_random_Rnd2(0,99);n=s>49?this.m_eng.p_CreateImage3(this.m_atlas,64,0,64,64,e,_,null):this.m_eng.p_CreateImage3(this.m_atlas,64,64,64,64,e,_,null),n.p_SetRadius(24,0)}return n.p_SetSpeed(i,A),n.p_SetAngle(bb_random_Rnd2(0,359),0),n.p_SetSpin(bb_random_Rnd2(-5,5),0),n.p_SetTag(t),n.p_SetWrapScreen(!0),n.p_SetLayer(this.m_layerGame),n.p_SetColGroup(2),n.p_SetID(2),this.m_cometCount+=1,n},c_game.prototype.p_SpawnComets=function(t){for(var e=1;t>=e;e+=1)this.m_obj=this.p_CreateComet(3,bb_random_Rnd2(64,this.m_eng.m_canvasWidth-64),bb_random_Rnd2(64,this.m_eng.m_canvasHeight-64),bb_random_Rnd2(1,4)/2,bb_random_Rnd2(0,359));return 0},c_game.prototype.p_StartNewGame=function(){return this.m_cometCount=0,this.m_lives=3,this.m_score=0,this.m_levelNumber=1,this.m_layerTitle.p_SetActive(!1),this.m_layerScore.p_SetActive(!1),this.m_player.p_SetPos(this.m_eng.m_canvasWidth/2,this.m_eng.m_canvasHeight/2,0),this.m_player.p_SetAngle(0,0),this.m_player.p_SetSpeed(0,9876.5),this.m_player.p_SetActive(!0),this.p_ActivateShield(),this.p_SpawnComets(5),this.m_eng.p_CreateObjTimer(this.m_obj,4,0|1e3+bb_random_Rnd2(0,1e4),0),this.m_gameMode=2,0},c_game.prototype.p_LoadHighScore=function(){var t=bb_app_LoadState();return 0!=t.length&&this.m_eng.m_scoreList.p_LoadFromString(t),0},c_game.prototype.p_ShowScoreList=function(){this.p_LoadHighScore();for(var t=1;t<=this.m_eng.m_scoreList.p_Count();t+=1)this.m_txtHighScores[t-1].p_SetText(String(this.m_eng.m_scoreList.p_GetValue(t)));return this.m_layerScore.p_SetActive(!0),this.m_layerTitle.p_SetActive(!1),0},c_game.prototype.p_OnUpdate=function(){var t=this.m_gameMode;return 2==t?0!=bb_input_KeyHit(80)?this.p_PauseGame():(this.m_eng.p_Update(this.p_UpdateGameTime()/60),this.m_eng.p_CollisionCheck2(this.m_layerGame),this.p_UpdateInfoText()):1==t||3==t?(0!=bb_input_KeyHit(80)&&this.p_StartNewGame(),0!=bb_input_KeyHit(72)&&this.p_ShowScoreList()):4==t?0!=bb_input_KeyHit(80)&&this.p_StartNewGame():5==t&&0!=bb_input_KeyHit(80)&&(this.m_eng.p_Update(0),this.m_gameMode=2),0},c_game.prototype.p_OnRender=function(){return bb_graphics_Cls(0,0,0),this.m_eng.p_Render(),0},c_game.prototype.p_SpawnExplosion=function(t,e,_){for(var i=1;t>=i;i+=1){var A=this.m_eng.p_CreateImage3(this.m_atlas,0,112,16,16,e,_,null);A.p_SetScale(bb_random_Rnd2(3,15)/10,0),A.p_SetAngle(bb_random_Rnd2(0,359),0),A.p_SetSpin(bb_random_Rnd2(-4,4),0),A.p_SetSpeed(bb_random_Rnd2(1,2),9876.5),A.p_SetLayer(this.m_layerFX),this.m_eng.p_CreateObjTimer(A,2,0|bb_random_Rnd2(100,2e3),0)}return this.m_sndExplo.p_Play(-1),0},c_game.prototype.p_SpawnPlayerEngine=function(){var t=this.m_player.p_GetVector(20,180+this.m_player.m_angle,!1);return this.m_obj=this.m_eng.p_CreateImage3(this.m_atlas,16,96,16,16,t[0],t[1],null),this.m_obj.p_SetAngle(this.m_player.m_angle,0),this.m_obj.p_SetScale(.5,0),this.m_obj.p_SetLayer(this.m_layerFX),this.m_eng.p_CreateObjTimer(this.m_obj,2,100,0),0},c_game.prototype.p_SpawnPlayerShot=function(){var t=this.m_player.p_GetVector(20,this.m_player.m_angle,!1),e=this.m_eng.p_CreateImage3(this.m_atlas,0,96,16,16,t[0],t[1],null);return e.p_SetAngle(this.m_player.m_angle,0),e.p_SetMaxSpeed(25),e.p_SetSpeed(this.m_player.m_speed+10,9876.5),e.p_SetLayer(this.m_layerGame),e.p_SetWrapScreen(!0),this.m_eng.p_CreateObjTimer(e,2,2100,0),e.p_SetColGroup(1),e.p_SetColWith2(2,1),e.p_SetRadius(3,0),this.m_sndShot.p_Play(-1),0},c_game.prototype.p_SaveHighScore=function(){var t=bb_RockSmash_g.m_eng.m_scoreList.p_SaveToString();return bb_app_SaveState(t),0};var bb_app__app=null;c_GameDelegate.prototype=extend_class(BBGameDelegate),c_GameDelegate.m_new=function(){return this},c_GameDelegate.prototype.StartGame=function(){this.m__graphics=new gxtkGraphics,bb_graphics_SetGraphicsDevice(this.m__graphics),bb_graphics_SetFont(null,32),this.m__audio=new gxtkAudio,bb_audio_SetAudioDevice(this.m__audio),this.m__input=c_InputDevice.m_new.call(new c_InputDevice),bb_input_SetInputDevice(this.m__input),bb_app__app.p_OnCreate()},c_GameDelegate.prototype.SuspendGame=function(){bb_app__app.p_OnSuspend(),this.m__audio.Suspend()},c_GameDelegate.prototype.ResumeGame=function(){this.m__audio.Resume(),bb_app__app.p_OnResume()},c_GameDelegate.prototype.UpdateGame=function(){this.m__input.p_BeginUpdate(),bb_app__app.p_OnUpdate(),this.m__input.p_EndUpdate()},c_GameDelegate.prototype.RenderGame=function(){var t=this.m__graphics.BeginRender();0!=t&&bb_graphics_BeginRender(),2==t?bb_app__app.p_OnLoading():bb_app__app.p_OnRender(),0!=t&&bb_graphics_EndRender(),this.m__graphics.EndRender()},c_GameDelegate.prototype.KeyEvent=function(t,e){if(this.m__input.p_KeyEvent(t,e),1==t){var _=e;432==_?bb_app__app.p_OnClose():416==_&&bb_app__app.p_OnBack()}},c_GameDelegate.prototype.MouseEvent=function(t,e,_,i){this.m__input.p_MouseEvent(t,e,_,i)},c_GameDelegate.prototype.TouchEvent=function(t,e,_,i){this.m__input.p_TouchEvent(t,e,_,i)},c_GameDelegate.prototype.MotionEvent=function(t,e,_,i,A){this.m__input.p_MotionEvent(t,e,_,i,A)},c_GameDelegate.prototype.DiscardGraphics=function(){this.m__graphics.DiscardGraphics()};var bb_app__delegate=null,bb_app__game=null,bb_RockSmash_g=null,bb_graphics_device=null;c_Image.m_DefaultFlags=0,c_Image.m_new=function(){return this},c_Image.prototype.p_SetHandle=function(t,e){return this.m_tx=t,this.m_ty=e,this.m_flags=-2&this.m_flags,0},c_Image.prototype.p_ApplyFlags=function(t){if(this.m_flags=t,0!=(2&this.m_flags)){for(var e=this.m_frames,_=0;_<e.length;){var i=e[_];_+=1,i.m_x+=1}this.m_width-=2}if(0!=(4&this.m_flags)){for(var A=this.m_frames,n=0;n<A.length;){var s=A[n];n+=1,s.m_y+=1}this.m_height-=2}return 0!=(1&this.m_flags)&&this.p_SetHandle(this.m_width/2,this.m_height/2),1==this.m_frames.length&&0==this.m_frames[0].m_x&&0==this.m_frames[0].m_y&&this.m_width==this.m_surface.Width()&&this.m_height==this.m_surface.Height()&&(this.m_flags|=65536),0},c_Image.prototype.p_Init=function(t,e,_){this.m_surface=t,this.m_width=0|this.m_surface.Width()/e,this.m_height=this.m_surface.Height(),this.m_frames=new_object_array(e);for(var i=0;e>i;i+=1)this.m_frames[i]=c_Frame.m_new.call(new c_Frame,i*this.m_width,0);return this.p_ApplyFlags(_),this},c_Image.prototype.p_Grab=function(t,e,_,i,A,n,s){this.m_source=s,this.m_surface=s.m_surface,this.m_width=_,this.m_height=i,this.m_frames=new_object_array(A);for(var r=t,a=e,m=0;A>m;m+=1)r+this.m_width>s.m_width&&(r=0,a+=this.m_height),(r+this.m_width>s.m_width||a+this.m_height>s.m_height)&&error("Image frame outside surface"),this.m_frames[m]=c_Frame.m_new.call(new c_Frame,r+s.m_frames[0].m_x,a+s.m_frames[0].m_y),r+=this.m_width;return this.p_ApplyFlags(n),this},c_Image.prototype.p_GrabImage=function(t,e,_,i,A,n){return 1!=this.m_frames.length?null:c_Image.m_new.call(new c_Image).p_Grab(t,e,_,i,A,n,this)},c_Image.prototype.p_Height=function(){return this.m_height},c_Image.prototype.p_Width=function(){return this.m_width},c_Image.prototype.p_Frames=function(){return this.m_frames.length},c_GraphicsContext.m_new=function(){return this},c_GraphicsContext.prototype.p_Validate=function(){return 0!=this.m_matDirty&&(bb_graphics_renderDevice.SetMatrix(bb_graphics_context.m_ix,bb_graphics_context.m_iy,bb_graphics_context.m_jx,bb_graphics_context.m_jy,bb_graphics_context.m_tx,bb_graphics_context.m_ty),this.m_matDirty=0),0};var bb_graphics_context=null;c_Frame.m_new=function(t,e){return this.m_x=t,this.m_y=e,this},c_Frame.m_new2=function(){return this};var bb_audio_device=null;c_InputDevice.m_new=function(){for(var t=0;4>t;t+=1)this.m__joyStates[t]=c_JoyState.m_new.call(new c_JoyState);return this},c_InputDevice.prototype.p_PutKeyHit=function(t){this.m__keyHitPut!=this.m__keyHitQueue.length&&(this.m__keyHit[t]+=1,this.m__keyHitQueue[this.m__keyHitPut]=t,this.m__keyHitPut+=1)
},c_InputDevice.prototype.p_BeginUpdate=function(){for(var t=0;4>t;t+=1){var e=this.m__joyStates[t];if(!BBGame.Game().PollJoystick(t,e.m_joyx,e.m_joyy,e.m_joyz,e.m_buttons))break;for(var _=0;32>_;_+=1){var i=256+32*t+_;e.m_buttons[_]?this.m__keyDown[i]||(this.m__keyDown[i]=!0,this.p_PutKeyHit(i)):this.m__keyDown[i]=!1}}},c_InputDevice.prototype.p_EndUpdate=function(){for(var t=0;t<this.m__keyHitPut;t+=1)this.m__keyHit[this.m__keyHitQueue[t]]=0;this.m__keyHitPut=0,this.m__charGet=0,this.m__charPut=0},c_InputDevice.prototype.p_KeyEvent=function(t,e){var _=t;1==_?this.m__keyDown[e]||(this.m__keyDown[e]=!0,this.p_PutKeyHit(e),1==e?(this.m__keyDown[384]=!0,this.p_PutKeyHit(384)):384==e&&(this.m__keyDown[1]=!0,this.p_PutKeyHit(1))):2==_?this.m__keyDown[e]&&(this.m__keyDown[e]=!1,1==e?this.m__keyDown[384]=!1:384==e&&(this.m__keyDown[1]=!1)):3==_&&this.m__charPut<this.m__charQueue.length&&(this.m__charQueue[this.m__charPut]=e,this.m__charPut+=1)},c_InputDevice.prototype.p_MouseEvent=function(t,e,_,i){var A=t;if(4==A)this.p_KeyEvent(1,1+e);else{if(5==A)return this.p_KeyEvent(2,1+e),void 0;if(6!=A)return}this.m__mouseX=_,this.m__mouseY=i,this.m__touchX[0]=_,this.m__touchY[0]=i},c_InputDevice.prototype.p_TouchEvent=function(t,e,_,i){var A=t;if(7==A)this.p_KeyEvent(1,384+e);else{if(8==A)return this.p_KeyEvent(2,384+e),void 0;if(9!=A)return}this.m__touchX[e]=_,this.m__touchY[e]=i,0==e&&(this.m__mouseX=_,this.m__mouseY=i)},c_InputDevice.prototype.p_MotionEvent=function(t,e,_,i,A){var n=t;10==n&&(this.m__accelX=_,this.m__accelY=i,this.m__accelZ=A)},c_InputDevice.prototype.p_KeyHit=function(t){return t>0&&512>t?this.m__keyHit[t]:0},c_InputDevice.prototype.p_KeyDown=function(t){return t>0&&512>t?this.m__keyDown[t]:!1},c_JoyState.m_new=function(){return this};var bb_input_device=null,bb_graphics_renderDevice=null,bb_app__updateRate=0;c_ftEngine.prototype.p_GetTime=function(){var t=bb_app_Millisecs();return this.m_engineTime+=(t-this.m_lastMillisecs)*this.m_timeScale,this.m_lastMillisecs=t,0|this.m_engineTime},c_ftEngine.m_new=function(){return this.m_defaultLayer=c_ftLayer.m_new.call(new c_ftLayer),this.m_defaultLayer.m_engine=this,this.m_layerList.p_AddLast2(this.m_defaultLayer),this.m_defaultScene=c_ftScene.m_new.call(new c_ftScene),this.m_defaultScene.m_engine=this,this.m_sceneList.p_AddLast3(this.m_defaultScene),this.m_screenWidth=bb_graphics_DeviceWidth(),this.m_screenHeight=bb_graphics_DeviceHeight(),this.m_canvasWidth=this.m_screenWidth,this.m_canvasHeight=this.m_screenHeight,this.m_time=this.p_GetTime(),this.m_lastTime=this.m_time,this.m_swiper=c_ftSwipe.m_new.call(new c_ftSwipe),this.m_swiper.m_engine=this,this.m_imgMng=c_ftImageManager.m_new.call(new c_ftImageManager),this.m_imgMng.m_engine=this,this},c_ftEngine.prototype.p_CreateLayer=function(t){var e=null;return e=null==t?c_ftLayer.m_new.call(new c_ftLayer):object_downcast(t,c_ftLayer),e.m_engine=this,e.m_engineNode=this.m_layerList.p_AddLast2(e),this.m_defaultScene.p_AddLayer(e),e},c_ftEngine.prototype.p_CreateImage=function(t,e,_,i){var A=null;return A=null==i?c_ftObject.m_new.call(new c_ftObject):object_downcast(i,c_ftObject),A.m_engine=this,A.m_xPos=e,A.m_yPos=_,A.m_type=0,A.m_objImg=this.m_imgMng.p_LoadImage2(t,1,1),null==A.m_objImg&&error("Image "+t+" not found!"),A.m_radius=bb_math_Max(A.m_objImg.m_img.p_Height(),A.m_objImg.m_img.p_Width())/2,A.m_w=A.m_objImg.m_img.p_Width(),A.m_h=A.m_objImg.m_img.p_Height(),A.m_rw=A.m_w,A.m_rh=A.m_h,A.p_SetLayer(this.m_defaultLayer),A.p_SetActive(this.m_defaultActive),A.p_SetVisible(this.m_defaultVisible),A.m_collType=0,A.p_internal_RotateSpriteCol(A),A},c_ftEngine.prototype.p_CreateImage2=function(t,e,_,i){var A=null;return A=null==i?c_ftObject.m_new.call(new c_ftObject):object_downcast(i,c_ftObject),A.m_engine=this,A.m_xPos=e,A.m_yPos=_,A.m_type=0,A.m_objImg=this.m_imgMng.p_LoadImage(t),A.m_radius=bb_math_Max(A.m_objImg.m_img.p_Height(),A.m_objImg.m_img.p_Width())/2,A.m_w=A.m_objImg.m_img.p_Width(),A.m_h=A.m_objImg.m_img.p_Height(),A.m_rw=A.m_w,A.m_rh=A.m_h,A.p_SetLayer(this.m_defaultLayer),A.p_SetActive(this.m_defaultActive),A.p_SetVisible(this.m_defaultVisible),A.m_collType=0,A.p_internal_RotateSpriteCol(A),A},c_ftEngine.prototype.p_CreateImage3=function(t,e,_,i,A,n,s,r){var a=null;return a=null==r?c_ftObject.m_new.call(new c_ftObject):object_downcast(r,c_ftObject),a.m_engine=this,a.m_xPos=n,a.m_yPos=s,a.m_type=0,a.m_objImg=this.m_imgMng.p_GrabImage3(t,e,_,i,A,1,1),a.m_radius=bb_math_Max(a.m_objImg.m_img.p_Height(),a.m_objImg.m_img.p_Width())/2,a.m_w=a.m_objImg.m_img.p_Width(),a.m_h=a.m_objImg.m_img.p_Height(),a.m_rw=a.m_w,a.m_rh=a.m_h,a.p_SetLayer(this.m_defaultLayer),a.p_SetActive(this.m_defaultActive),a.p_SetVisible(this.m_defaultVisible),a.m_collType=0,a.p_internal_RotateSpriteCol(a),a},c_ftEngine.prototype.p_CreateImage4=function(t,e,_,i,A,n){var s=null;s=null==n?c_ftObject.m_new.call(new c_ftObject):object_downcast(n,c_ftObject);var r=bb_app_LoadString(e),a=r.split(String.fromCharCode(10)),m=0,o=0,h=0,c=0,p=0;if(e.toLowerCase().indexOf(".txt",0)>0){p=a.length;for(var l=0;p-1>=l;l+=1)if(a[l].toLowerCase()==_.toLowerCase()){var u=a[l+1];u=string_trim(string_replace(u,"rotate:","")),"true"==u.toLowerCase()&&(s.m_offAngle=-90);var d=a[l+2];d=string_trim(string_replace(d,"xy:",""));var g=d.split(",");m=parseInt(g[0],10),o=parseInt(g[1],10);var f=a[l+3];f=string_trim(string_replace(f,"size:",""));var b=f.split(",");h=parseInt(b[0],10),c=parseInt(b[1],10)}}else{p=a.length;for(var y=0;p-1>=y;y+=1){var v=string_trim(a[y].toLowerCase());if(-1!=v.indexOf(string_fromchars([34])+_.toLowerCase()+string_fromchars([34]))){print(v),v=string_replace(v,string_fromchars([34]),""),print(v),v=string_replace(v,"<subtexture ",""),print(v),v=string_replace(v,"/>",""),print(v);var x=v.split(" "),S=x[1],w=S.split("=");m=parseInt(w[1],10);var L=x[2],j=L.split("=");o=parseInt(j[1],10);var O=x[3],C=O.split("=");h=parseInt(C[1],10);var P=x[4],E=P.split("=");c=parseInt(E[1],10)}}}return s.m_engine=this,s.m_xPos=i,s.m_yPos=A,s.m_type=0,s.m_objImg=this.m_imgMng.p_GrabImage3(t,m,o,h,c,1,1),s.m_radius=bb_math_Max(s.m_objImg.m_img.p_Height(),s.m_objImg.m_img.p_Width())/2,s.m_offAngle<0?(s.m_h=s.m_objImg.m_img.p_Width(),s.m_w=s.m_objImg.m_img.p_Height()):(s.m_w=s.m_objImg.m_img.p_Width(),s.m_h=s.m_objImg.m_img.p_Height()),s.m_rw=s.m_objImg.m_img.p_Width(),s.m_rh=s.m_objImg.m_img.p_Height(),s.p_SetLayer(this.m_defaultLayer),s.p_SetActive(this.m_defaultActive),s.p_SetVisible(this.m_defaultVisible),s.m_collType=0,s.p_internal_RotateSpriteCol(s),s},c_ftEngine.prototype.p_LoadSound=function(t,e){var _=c_ftSound.m_new.call(new c_ftSound);return _.m_engine=this,_.m_name=t,_.m_loop=e,_.m_isMusic=!1,_.m_sound=t.lastIndexOf(".")<1?bb_audio_LoadSound(t+".ogg"):bb_audio_LoadSound(t),_.m_soundNode=this.m_soundList.p_AddLast5(_),_},c_ftEngine.prototype.p_LoadFont=function(t){var e=c_ftFont.m_new.call(new c_ftFont);return e.p_Load(t),this.m_fontList.p_AddLast6(e),e},c_ftEngine.prototype.p_CreateText=function(t,e,_,i,A){var n=c_ftObject.m_new.call(new c_ftObject);return n.m_objFont=t,n.m_engine=this,n.m_textMode=A,n.m_xPos=_,n.m_yPos=i,n.m_type=1,n.p_SetText(e),n.p_SetLayer(this.m_defaultLayer),n.p_SetActive(this.m_defaultActive),n.p_SetVisible(this.m_defaultVisible),n.m_collType=2,n.p_internal_RotateSpriteCol(n),n},c_ftEngine.prototype.p_OnTimer=function(){return 0},c_ftEngine.prototype.p_OnObjectTimer=function(){return 0},c_ftEngine.prototype.p_OnObjectTransition=function(){return 0},c_ftEngine.prototype.p_OnLayerTransition=function(){return 0},c_ftEngine.prototype.p_OnObjectUpdate=function(){return 0},c_ftEngine.prototype.p_OnLayerUpdate=function(){return 0},c_ftEngine.prototype.p_OnObjectDelete=function(){return 0},c_ftEngine.prototype.p_Update=function(t){this.m_time=this.p_GetTime();for(var e=this.m_timerList.p_Backwards().p_ObjectEnumerator();e.p_HasNext();){var _=e.p_NextObject();_.p_Update3()}for(var i=this.m_layerList.p_ObjectEnumerator();i.p_HasNext();){var A=i.p_NextObject();A.m_isActive&&A.p_Update(t)}},c_ftEngine.prototype.p_Update2=function(t,e){this.m_time=this.p_GetTime();for(var _=this.m_timerList.p_Backwards().p_ObjectEnumerator();_.p_HasNext();){var i=_.p_NextObject();i.p_Update3()}t.m_isActive&&t.p_Update(e)},c_ftEngine.prototype.p_OnObjectCollision=function(){return 0},c_ftEngine.prototype.p_CollisionCheck=function(){for(var t=this.m_layerList.p_ObjectEnumerator();t.p_HasNext();){var e=t.p_NextObject();e.m_isActive&&e.p_CollisionCheck()}},c_ftEngine.prototype.p_CollisionCheck2=function(t){t.m_isActive&&t.p_CollisionCheck()},c_ftEngine.prototype.p_CollisionCheck3=function(t){t.m_layer.m_isActive&&t.m_layer.p_CollisionCheck3(t)},c_ftEngine.prototype.p_CreateObjTimer=function(t,e,_,i){var A=null;return A=t.p_CreateTimer(e,_,i)},c_ftEngine.prototype.p_GetCanvasWidth=function(){return 0|this.m_canvasWidth},c_ftEngine.prototype.p_GetCanvasHeight=function(){return 0|this.m_canvasHeight},c_ftEngine.prototype.p_OnObjectRender=function(){return 0},c_ftEngine.prototype.p_Render=function(){this.m_red=255,this.m_green=255,this.m_blue=255,bb_graphics_SetColor(255,255,255),bb_graphics_PushMatrix(),bb_graphics_Translate(this.m_autofitX,this.m_autofitY),bb_graphics_Scale(this.m_scaleX,this.m_scaleY),bb_graphics_SetScissor(this.m_autofitX,this.m_autofitY,this.m_canvasWidth*this.m_scaleX,this.m_canvasHeight*this.m_scaleY);for(var t=this.m_layerList.p_ObjectEnumerator();t.p_HasNext();){var e=t.p_NextObject();e.m_isVisible&&e.m_isActive&&e.p_Render()}bb_graphics_PopMatrix()},c_ftEngine.prototype.p_Render2=function(t){this.m_red=255,this.m_green=255,this.m_blue=255,bb_graphics_SetColor(255,255,255),bb_graphics_PushMatrix(),bb_graphics_Translate(this.m_autofitX,this.m_autofitY),bb_graphics_Scale(this.m_scaleX,this.m_scaleY),bb_graphics_SetScissor(this.m_autofitX,this.m_autofitY,this.m_canvasWidth*this.m_scaleX,this.m_canvasHeight*this.m_scaleY),t.m_isVisible&&t.m_isActive&&t.p_Render(),bb_graphics_PopMatrix()},c_engine.prototype=extend_class(c_ftEngine),c_engine.m_new=function(){return c_ftEngine.m_new.call(this),this},c_engine.prototype.p_OnObjectCollision=function(t,e){var _=0;if(2==e.m_collGroup){if(3==e.m_tag){for(bb_RockSmash_g.p_SpawnExplosion(15,t.m_xPos,t.m_yPos),_=1;2>=_;_+=1)bb_RockSmash_g.p_CreateComet(2,e.m_xPos,e.m_yPos,bb_random_Rnd2(1,4)/2,bb_random_Rnd2(0,359));bb_RockSmash_g.m_score=bb_RockSmash_g.m_score+100}if(2==e.m_tag){for(bb_RockSmash_g.p_SpawnExplosion(10,t.m_xPos,t.m_yPos),_=1;3>=_;_+=1)bb_RockSmash_g.p_CreateComet(1,e.m_xPos,e.m_yPos,bb_random_Rnd2(1,4)/2,bb_random_Rnd2(0,359));bb_RockSmash_g.m_score=bb_RockSmash_g.m_score+250}1==e.m_tag&&(bb_RockSmash_g.p_SpawnExplosion(5,t.m_xPos,t.m_yPos),bb_RockSmash_g.m_score=bb_RockSmash_g.m_score+500),bb_RockSmash_g.m_cometCount-=1,e.p_Remove(!1)}return 1==t.m_collGroup&&t.p_Remove(!1),3==t.m_collGroup&&(bb_RockSmash_g.p_SpawnExplosion(5,t.m_xPos,t.m_yPos),bb_RockSmash_g.m_lives-=1,e.p_Remove(!1)),10==e.m_collGroup&&e.p_Remove(!1),10==e.m_collGroup&&print("Boss Hit"),0},c_engine.prototype.p_OnObjectTimer=function(t,e){return 2==t&&e.p_Remove(!1),3==t&&(e.p_SetActive(!1),bb_RockSmash_g.m_player.p_SetColGroup(3)),0},c_engine.prototype.p_OnObjectUpdate=function(t){return 2==bb_RockSmash_g.m_gameMode&&t==bb_RockSmash_g.m_player&&(0!=bb_input_KeyDown(38)&&(t.p_AddSpeed(1.5*this.m_delta,9876.5),bb_RockSmash_g.p_SpawnPlayerEngine()),0!=bb_input_KeyDown(37)&&t.p_SetAngle(-15*this.m_delta,1),0!=bb_input_KeyDown(39)&&t.p_SetAngle(15*this.m_delta,1),0!=bb_input_KeyHit(83)&&bb_RockSmash_g.p_SpawnPlayerShot(),0!=bb_input_KeyHit(32)&&0==bb_RockSmash_g.m_shield.m_isActive&&bb_RockSmash_g.p_ActivateShield()),0},c_engine.prototype.p_OnLayerUpdate=function(t){if(t==bb_RockSmash_g.m_layerGame&&2==bb_RockSmash_g.m_gameMode){if(bb_RockSmash_g.m_lives<=0)return bb_RockSmash_g.m_gameMode=3,bb_RockSmash_g.m_layerTitle.p_SetActive(!0),bb_RockSmash_g.m_eng.m_scoreList.p_AddScore(bb_RockSmash_g.m_score,"---"),bb_RockSmash_g.m_player.p_SetActive(!1),bb_RockSmash_g.m_layerFX.p_RemoveAllObjects(),t.p_RemoveAllObjectsByID(2),bb_RockSmash_g.p_SaveHighScore(),0;bb_RockSmash_g.m_cometCount<=0&&2==bb_RockSmash_g.m_gameMode&&(bb_RockSmash_g.p_ActivateShield(),bb_RockSmash_g.m_levelNumber+=1,bb_RockSmash_g.p_SpawnComets(4+bb_RockSmash_g.m_levelNumber),bb_RockSmash_g.m_lives+=1)}return 0},c_ftLayer.m_new=function(){return this.m_objList.m_layer=this,this},c_ftLayer.prototype.p_SetActive=function(t){this.m_isActive=t},c_ftLayer.prototype.p_SetPos=function(t,e,_){1==_?(this.m_xPos=this.m_xPos+t,this.m_yPos=this.m_yPos+e):(this.m_xPos=t,this.m_yPos=e)},c_ftLayer.prototype.p_SetScale=function(t,e){1==e?this.m_scale+=t:this.m_scale=t},c_ftLayer.prototype.p_SetAlpha=function(t,e){1==e?this.m_alpha+=t:this.m_alpha=t,this.m_alpha<0&&(this.m_alpha=0),this.m_alpha>1&&(this.m_alpha=1)},c_ftLayer.prototype.p_CleanupLists=function(){for(var t=this.m_transitionList.p_ObjectEnumerator();t.p_HasNext();){var e=t.p_NextObject();e.m_deleted&&e.p_Cancel()}for(var _=this.m_objList.p_Backwards().p_ObjectEnumerator();_.p_HasNext();){var i=_.p_NextObject();i.m_deleted&&i.p_Remove(!0)}},c_ftLayer.prototype.p_Update=function(t){if(this.m_inUpdate=!0,this.m_engine.m_delta=t,0==this.m_engine.m_isPaused)for(var e=this.m_transitionList.p_ObjectEnumerator();e.p_HasNext();){var _=e.p_NextObject();_.p_Update3()}for(var i=this.m_objList.p_ObjectEnumerator();i.p_HasNext();){var A=i.p_NextObject();null==A.m_parentObj&&A.p_Update(t)}0==this.m_engine.m_isPaused&&this.m_engine.p_OnLayerUpdate(this),this.p_CleanupLists(),0==this.m_inTouch&&this.p_CleanupLists(),this.m_inUpdate=!1},c_ftLayer.prototype.p_CollisionCheck=function(){for(var t=null,e=null,_=this.m_objList.p_ObjectEnumerator();_.p_HasNext();)if(t=_.p_NextObject(),1==t.m_isActive&&t.m_collGroup>0&&1==t.m_colCheck)for(var i=this.m_objList.p_ObjectEnumerator();i.p_HasNext();)e=i.p_NextObject(),t!=e&&t.p_CheckCollision(e)&&this.m_engine.p_OnObjectCollision(t,e);this.p_CleanupLists()},c_ftLayer.prototype.p_CollisionCheck3=function(t){var e=null;if(1==t.m_isActive){if(t.m_collGroup>0)for(var _=this.m_objList.p_ObjectEnumerator();_.p_HasNext();)e=_.p_NextObject(),t!=e&&t.p_CheckCollision(e)&&this.m_engine.p_OnObjectCollision(t,e);1==t.m_deleted&&t.p_Remove(!0)}},c_ftLayer.prototype.p_Render=function(){if(bb_graphics_PushMatrix(),0!=this.m_angle&&bb_cftMisc_RotateDisplay(this.m_engine.p_GetCanvasWidth()/2,this.m_engine.p_GetCanvasHeight()/2,-this.m_angle),this.m_engine.m_lastLayerAngle=this.m_angle,this.m_scale!=this.m_engine.m_lastLayerScale&&(bb_graphics_Scale(this.m_scale,this.m_scale),this.m_engine.m_lastLayerScale=this.m_scale),1==this.m_isVisible)for(var t=this.m_objList.p_ObjectEnumerator();t.p_HasNext();){var e=t.p_NextObject();1==this.m_isGUI?e.m_isVisible&&e.m_isActive&&null==e.m_parentObj&&e.p_Render3(this.m_xPos,this.m_yPos):e.m_isVisible&&e.m_isActive&&null==e.m_parentObj&&e.p_Render3(this.m_xPos-this.m_engine.m_camX,this.m_yPos-this.m_engine.m_camY)}bb_graphics_PopMatrix()},c_ftLayer.prototype.p_RemoveAllObjects=function(){for(var t=this.m_objList.p_Backwards().p_ObjectEnumerator();t.p_HasNext();){var e=t.p_NextObject();this.m_inUpdate||this.m_inTouch?e.p_Remove(!1):e.p_Remove(!0)}},c_ftLayer.prototype.p_RemoveAllObjectsByID=function(t){for(var e=this.m_objList.p_Backwards().p_ObjectEnumerator();e.p_HasNext();){var _=e.p_NextObject();_.m_id==t&&(this.m_inUpdate||this.m_inTouch?_.p_Remove(!1):_.p_Remove(!0))}},c_ftObject.m_new=function(){return this},c_ftObject.prototype.p_SetLayer=function(t){null!=this.m_layer&&this.m_layerNode.p_Remove2(),null!=t&&(this.m_layerNode=t.m_objList.p_AddLast(this)),this.m_layer=t},c_ftObject.prototype.p_SetActive=function(t){this.m_isActive=t},c_ftObject.prototype.p_SetVisible=function(t){this.m_isVisible=t},c_ftObject.prototype.p_internal_RotateSpriteCol=function(t){var e=0,_=0,i=0,A=0,n=0,s=0,r=0,a=0,m=0;return this.m_hOffX=(.5-this.m_handleX)*this.m_w*this.m_scaleX,this.m_hOffY=(.5-this.m_handleY)*this.m_h*this.m_scaleY,m=.0174533*(t.m_angle+t.m_offAngle),i=Math.sin(m),A=Math.cos(m),e=-t.m_w/2*t.m_scaleX*t.m_collScale,1==this.m_isFlipV&&(_=-1*_),_=t.m_h/2*t.m_scaleY*t.m_collScale,1==this.m_isFlipH&&(e=-1*e),r=e*A,a=_*A,n=e*i,s=_*i,t.m_x1c=r-s+this.m_hOffX,t.m_y1c=a+n+this.m_hOffY,t.m_x2c=-r-s+this.m_hOffX,t.m_y2c=a+-n+this.m_hOffY,t.m_x3c=-r- -s+this.m_hOffX,t.m_y3c=-a+-n+this.m_hOffY,t.m_x4c=r- -s+this.m_hOffX,t.m_y4c=-a+n+this.m_hOffY,0},c_ftObject.prototype.p_SetScale=function(t,e){var _=0;if(1==e)for(var i=this.m_childObjList.p_ObjectEnumerator();i.p_HasNext();){var A=i.p_NextObject();A.p_SetScale(t,e)}else for(var n=this.m_childObjList.p_ObjectEnumerator();n.p_HasNext();){var s=n.p_NextObject();_=this.m_scaleX-s.m_scaleX,s.p_SetScale(t-_,e)}1==e?(this.m_scaleX+=t,this.m_scaleY+=t):(this.m_scaleX=t,this.m_scaleY=t),this.p_internal_RotateSpriteCol(this)},c_ftObject.prototype.p_GetTargetAngle=function(t,e){var _=0,i=0,A=0;return _=t.m_xPos-this.m_xPos,i=t.m_yPos-this.m_yPos,A=Math.atan2(i,_)*R2D+90,0>A&&(A=360+A),1==e&&(A-=this.m_angle,A>180?A-=360:-180>A&&(A+=360)),A},c_ftObject.prototype.p_GetRadius=function(){return this.m_radius*this.m_scaleX},c_ftObject.prototype.p_GetTargetDist=function(t,e){var _=0,i=0,A=0;return _=t.m_xPos-this.m_xPos,i=t.m_yPos-this.m_yPos,A=Math.sqrt(_*_+i*i),1==e&&(A=A-this.p_GetRadius()-t.p_GetRadius()),A},c_ftObject.prototype.p_GetVector=function(t,e,_){var i=new_number_array(2),A=0;return A=1==_?this.m_angle+e:e,i[0]=this.m_xPos+Math.sin(A*D2R)*t,i[1]=this.m_yPos-Math.cos(A*D2R)*t,i},c_ftObject.prototype.p_SetPos=function(t,e,_){var i=0,A=0;if(1==_)for(var n=this.m_childObjList.p_ObjectEnumerator();n.p_HasNext();){var s=n.p_NextObject();s.p_SetPos(t,e,_)}else for(var r=this.m_childObjList.p_ObjectEnumerator();r.p_HasNext();){var a=r.p_NextObject();i=this.m_xPos-a.m_xPos,A=this.m_yPos-a.m_yPos,a.p_SetPos(t-i,e-A,_)}1==_?(this.m_xPos=this.m_xPos+t,this.m_yPos=this.m_yPos+e):(this.m_xPos=t,this.m_yPos=e)},c_ftObject.prototype.p_internal_OrbitChild=function(t){var e=this.m_parentObj,_=e.p_GetTargetAngle(this,0),i=e.p_GetTargetDist(this,!1),A=e.p_GetVector(i,_+t,!1);return this.p_SetPos(A[0],A[1],0),0},c_ftObject.prototype.p_SetAngle=function(t,e){var _=0;1==e?(_=t,this.m_angle=this.m_angle+t):(_=t-this.m_angle,this.m_angle=t);for(var i=this.m_childObjList.p_ObjectEnumerator();i.p_HasNext();){var A=i.p_NextObject();A.p_internal_OrbitChild(_),A.p_SetAngle(t,e)}this.m_angle>360&&(this.m_angle=this.m_angle-360),this.m_angle<0&&(this.m_angle=this.m_angle+360),this.p_internal_RotateSpriteCol(this)},c_ftObject.prototype.p_SetSpin=function(t,e){this.m_speedSpin=1==e?this.m_speedSpin+t:t},c_ftObject.prototype.p_SetFriction=function(t,e){1==e?this.m_friction+=t:this.m_friction=t},c_ftObject.prototype.p_SetMaxSpeed=function(t){this.m_speedMax=t},c_ftObject.prototype.p_SetWrapScreen=function(t){this.m_isWrappingX=t,this.m_isWrappingY=t},c_ftObject.prototype.p_SetColGroup=function(t){var e=this.m_collWith.length;(0>t||t>e)&&error("\n\nError in file fantomEngine.cftObject, Method ftObject.SetColGroup(collisionGroup:Int):\n\nUsed index is wrong. Bounds are 0-"+String(e)+"."),this.m_collGroup=t},c_ftObject.prototype.p_SetColWith=function(t,e,_){var i=this.m_collWith.length;(1>t||e>i||t>e)&&error("\n\nError in file fantomEngine.cftObject, Method ftObject.SetColWith(startIndex:Int, endIndex:Int, boolFlag:Bool):\n\nUsed index is wrong. Bounds are 1-"+String(i)+".");for(var A=t-1;e-1>=A;A+=1)this.m_collWith[A]=_?1:0;if(1==_)this.m_colCheck=!0;else{this.m_colCheck=!1;for(var n=0;i>=n;n+=1)if(1==this.m_collWith[n]){this.m_colCheck=!0;break}}},c_ftObject.prototype.p_SetColWith2=function(t,e){var _=this.m_collWith.length;if((1>t||t>_)&&error("\n\nError in file fantomEngine.cftObject, Method ftObject.SetColWith(index, boolFlag):\n\nUsed index ("+String(t)+") is out of bounds (1-"+String(_)+")"),this.m_collWith[t-1]=e,1==e)this.m_colCheck=!0;else{this.m_colCheck=!1;for(var i=0;_-1>=i;i+=1)if(1==this.m_collWith[i]){this.m_colCheck=!0;break}}},c_ftObject.prototype.p_SetRadius=function(t,e){1==e?this.m_radius+=t/this.m_scaleX:this.m_radius=t/this.m_scaleX},c_ftObject.prototype.p_SetParent=function(t){null!=this.m_parentObj&&(this.m_parentNode.p_Remove2(),this.m_parentNode=null),null!=t&&(this.m_parentNode=t.m_childObjList.p_AddLast(this)),this.m_parentObj=t},c_ftObject.prototype.p_SetText=function(t){var e=0;this.m_text=t;var _=t.split("\n");if(e=_.length,1==this.m_type||7==this.m_type){if(1>=e&&1==this.m_type)this.m_w=this.m_objFont.p_Length(t);else{this.m_type=7,this.m_w=0;for(var i=1;e>=i;i+=1)this.m_w=bb_math_Max2(this.m_w,this.m_objFont.p_Length(_[i-1]))}this.m_h=this.m_objFont.m_lineHeight*e,this.m_rh=this.m_h,this.m_rw=this.m_w,this.m_radius=bb_math_Max2(this.m_h,this.m_w)/2}},c_ftObject.prototype.p_SetAlpha=function(t,e){1==e?this.m_alpha+=t:this.m_alpha=t,this.m_alpha<0&&(this.m_alpha=0),this.m_alpha>1&&(this.m_alpha=1)},c_ftObject.prototype.p_SetPosX=function(t,e){var _=0;if(1==e)for(var i=this.m_childObjList.p_ObjectEnumerator();i.p_HasNext();){var A=i.p_NextObject();A.p_SetPosX(t,e)}else for(var n=this.m_childObjList.p_ObjectEnumerator();n.p_HasNext();){var s=n.p_NextObject();_=this.m_xPos-s.m_xPos,s.p_SetPosX(t-_,e)}this.m_xPos=1==e?this.m_xPos+t:t},c_ftObject.prototype.p_SetPosY=function(t,e){var _=0;if(1==e)for(var i=this.m_childObjList.p_ObjectEnumerator();i.p_HasNext();){var A=i.p_NextObject();A.p_SetPosY(t,e)}else for(var n=this.m_childObjList.p_ObjectEnumerator();n.p_HasNext();){var s=n.p_NextObject();_=this.m_yPos-s.m_yPos,s.p_SetPosY(t-_,e)}this.m_yPos=1==e?this.m_yPos+t:t},c_ftObject.prototype.p_WrapScreenX=function(){this.m_xPos<0&&this.p_SetPos(this.m_engine.m_canvasWidth,0,1),this.m_xPos>this.m_engine.m_canvasWidth&&this.p_SetPos(-this.m_engine.m_canvasWidth,0,1)},c_ftObject.prototype.p_WrapScreenY=function(){this.m_yPos<0&&this.p_SetPos(0,this.m_engine.m_canvasHeight,1),this.m_yPos>this.m_engine.m_canvasHeight&&this.p_SetPos(0,-this.m_engine.m_canvasHeight,1)},c_ftObject.prototype.p_CleanupLists=function(){for(var t=this.m_transitionList.p_ObjectEnumerator();t.p_HasNext();){var e=t.p_NextObject();e.m_deleted&&e.p_Cancel()}for(var _=this.m_timerList.p_ObjectEnumerator();_.p_HasNext();){var i=_.p_NextObject();i.m_deleted&&i.p_RemoveTimer()}},c_ftObject.prototype.p_Update=function(t){if(1==this.m_isActive&&0==this.m_deleted){if(0==this.m_engine.m_isPaused){1==this.m_isAnimated&&(this.m_animTime+=t*this.m_engine.m_timeScale,this.m_animTime>this.m_frameEnd*this.m_frameTime&&(this.m_animTime-=this.m_frameLength*this.m_frameTime));var e=this.m_speed,_=this.m_friction*t*this.m_engine.m_timeScale;if(e>=0?(e-=_,_>e&&(e=0),this.m_speed=e,this.m_speedX=Math.sin(this.m_speedAngle*D2R)*e,this.m_speedY=-Math.cos(this.m_speedAngle*D2R)*e,0!=this.m_speed&&this.p_SetPos(this.m_speedX*t*this.m_engine.m_timeScale,this.m_speedY*t*this.m_engine.m_timeScale,1)):(e+=_,e>_&&(e=0),this.m_speed=e,this.m_speedX=Math.sin(this.m_speedAngle*D2R)*e,this.m_speedY=-Math.cos(this.m_speedAngle*D2R)*e,0!=this.m_speed&&this.p_SetPos(this.m_speedX*t*this.m_engine.m_timeScale,this.m_speedY*t*this.m_engine.m_timeScale,1)),0!=this.m_speedSpin){var i=this.m_speedSpin;0>i&&(i=-1*i),this.m_speedSpin=_>i?0:this.m_speedSpin>0?this.m_speedSpin-_:this.m_speedSpin+_}0!=this.m_speedSpin&&this.p_SetAngle(this.m_speedSpin*t*this.m_engine.m_timeScale,1),this.m_isWrappingX&&this.p_WrapScreenX(),this.m_isWrappingY&&this.p_WrapScreenY()}for(var A=this.m_childObjList.p_ObjectEnumerator();A.p_HasNext();){var n=A.p_NextObject();n.m_isActive&&n.p_Update(t)}for(var s=this.m_transitionList.p_ObjectEnumerator();s.p_HasNext();){var r=s.p_NextObject();r.p_Update3()}for(var a=this.m_timerList.p_ObjectEnumerator();a.p_HasNext();){var m=a.p_NextObject();m.p_Update3()}0==this.m_engine.m_isPaused&&1==this.m_onUpdateEvent&&this.m_engine.p_OnObjectUpdate(this)}this.p_CleanupLists()},c_ftObject.prototype.p_Remove=function(t){for(var e=this.m_childObjList.p_ObjectEnumerator();e.p_HasNext();){var _=e.p_NextObject();_.p_Remove(t)}for(var i=this.m_transitionList.p_ObjectEnumerator();i.p_HasNext();){var A=i.p_NextObject();A.p_Cancel()}for(var n=this.m_timerList.p_ObjectEnumerator();n.p_HasNext();){var s=n.p_NextObject();s.p_RemoveTimer()}1==t?(null!=this.m_parentObj&&(this.m_parentNode.p_Remove2(),this.m_parentObj=null),null!=this.m_layer&&(this.m_layerNode.p_Remove2(),this.m_layer=null),null!=this.m_marker&&(this.m_markerNode.p_Remove2(),this.m_marker=null),1==this.m_onDeleteEvent&&this.m_engine.p_OnObjectDelete(this)):this.m_deleted=!0},c_ftObject.prototype.p_internal_PointToPointDist=function(t,e,_,i){var A=0,n=0;return A=t-_,n=e-i,Math.sqrt(A*A+n*n)},c_ftObject.prototype.p_internal_Line2Circle=function(t,e,_,i,A,n,s){var r=0,a=0,m=0,o=0,h=0;return r=_-t,a=i-e,h=((A-t)*(_-t)+(n-e)*(i-e))/(r*r+a*a),0>h&&(h=0),h>1&&(h=1),m=(1-h)*t+h*_,o=(1-h)*e+h*i,this.p_internal_PointToPointDist(A,n,m,o)<s},c_ftObject.prototype.p_internal_Circle2LineObj=function(t,e){var _=0,i=c_tPointS.m_new.call(new c_tPointS),A=c_tPointS.m_new.call(new c_tPointS),n=0,s=0;return n=t.m_xPos+t.m_hOffX,s=t.m_yPos+t.m_hOffY,_=t.m_radius*t.m_scaleX*t.m_collScale,i.m_x=e.m_x1c+e.m_xPos,i.m_y=e.m_y1c+e.m_yPos,A.m_x=e.m_x2c+e.m_xPos,A.m_y=e.m_y2c+e.m_yPos,this.p_internal_Line2Circle(i.m_x,i.m_y,A.m_x,A.m_y,n,s,_)?!0:!1},c_ftObject.prototype.p_internal_PointInsidePolygon=function(t,e,_){var i=0,A=0,n=0,s=0,r=0,a=0,m=0,o=0;return n=Math.sin(-t.m_angle),s=Math.cos(-t.m_angle),i=e-t.m_xPos,A=_-t.m_yPos,e=i*s-A*n+t.m_xPos,_=A*s+i*n+t.m_yPos,m=t.m_xPos+t.m_hOffX-t.m_w*t.m_scaleX*t.m_collScale/2+1,o=m+t.m_w*t.m_scaleX*t.m_collScale-2,r=t.m_yPos+t.m_hOffY-t.m_h*t.m_scaleY*t.m_collScale/2+1,a+=r+t.m_h*t.m_scaleY*t.m_collScale-2,m>e||e>o||r>_||_>a?!1:!0},c_ftObject.prototype.p_internal_Circle2Box=function(t,e){var _=0,i=c_tPointS.m_new.call(new c_tPointS),A=c_tPointS.m_new.call(new c_tPointS),n=c_tPointS.m_new.call(new c_tPointS),s=c_tPointS.m_new.call(new c_tPointS),r=0,a=0;return r=t.m_xPos+t.m_hOffX,a=t.m_yPos+t.m_hOffY,this.p_internal_PointInsidePolygon(e,r,a)?!0:(_=t.m_radius*t.m_scaleX*t.m_collScale,i.m_x=e.m_x1c+e.m_xPos,i.m_y=e.m_y1c+e.m_yPos,A.m_x=e.m_x2c+e.m_xPos,A.m_y=e.m_y2c+e.m_yPos,n.m_x=e.m_x3c+e.m_xPos,n.m_y=e.m_y3c+e.m_yPos,s.m_x=e.m_x4c+e.m_xPos,s.m_y=e.m_y4c+e.m_yPos,this.p_internal_Line2Circle(i.m_x,i.m_y,A.m_x,A.m_y,r,a,_)?!0:this.p_internal_Line2Circle(A.m_x,A.m_y,n.m_x,n.m_y,r,a,_)?!0:this.p_internal_Line2Circle(n.m_x,n.m_y,s.m_x,s.m_y,r,a,_)?!0:this.p_internal_Line2Circle(s.m_x,s.m_y,i.m_x,i.m_y,r,a,_)?!0:!1)},c_ftObject.prototype.p_internal_Circle2Circle=function(t,e){var _=0,i=0,A=0;return _=t.m_xPos+t.m_hOffX-(e.m_xPos+e.m_hOffX),_*=_,i=t.m_yPos+t.m_hOffY-(e.m_yPos+e.m_hOffY),i*=i,A=t.m_radius*t.m_scaleX*t.m_collScale+e.m_radius*e.m_scaleX*e.m_collScale,A*=A,A>_+i?!0:!1},c_ftObject.prototype.p_internal_Box2Circle=function(t,e){var _=0,i=c_tPointS.m_new.call(new c_tPointS),A=c_tPointS.m_new.call(new c_tPointS),n=c_tPointS.m_new.call(new c_tPointS),s=c_tPointS.m_new.call(new c_tPointS),r=0,a=0;return r=e.m_xPos+e.m_hOffX,a=e.m_yPos+e.m_hOffY,this.p_internal_PointInsidePolygon(t,r,a)?!0:(_=e.m_radius*e.m_scaleX,i.m_x=t.m_x1c+t.m_xPos,i.m_y=t.m_y1c+t.m_yPos,A.m_x=t.m_x2c+t.m_xPos,A.m_y=t.m_y2c+t.m_yPos,n.m_x=t.m_x3c+t.m_xPos,n.m_y=t.m_y3c+t.m_yPos,s.m_x=t.m_x4c+t.m_xPos,s.m_y=t.m_y4c+t.m_yPos,this.p_internal_Line2Circle(i.m_x,i.m_y,A.m_x,A.m_y,r,a,_)?!0:this.p_internal_Line2Circle(A.m_x,A.m_y,n.m_x,n.m_y,r,a,_)?!0:this.p_internal_Line2Circle(n.m_x,n.m_y,s.m_x,s.m_y,r,a,_)?!0:this.p_internal_Line2Circle(s.m_x,s.m_y,i.m_x,i.m_y,r,a,_)?!0:!1)},c_ftObject.prototype.p_internal_Circle2CircleInBox=function(t,e){var _=0,i=0,A=0;return _=t.m_xPos+t.m_hOffX-(e.m_xPos+e.m_hOffX),_*=_,i=t.m_yPos+t.m_hOffY-(e.m_yPos+e.m_hOffY),i*=i,A=1.42*(t.m_radius*t.m_scaleX+e.m_radius*e.m_scaleX),A*=A,A>_+i?!0:!1},c_ftObject.prototype.p_internal_Vec2DotProduct=function(t,e){return t.m_x*e.m_x+t.m_y*e.m_y},c_ftObject.prototype.p_internal_between=function(t,e,_){return t>=e&&_>=t?!0:!1},c_ftObject.prototype.p_internal_Collided_IsIn=function(t,e,_,i){var A=c_tPointS.m_new.call(new c_tPointS),n=c_tPointS.m_new.call(new c_tPointS),s=c_tPointS.m_new.call(new c_tPointS);return A.m_x=t.m_x-e.m_x,A.m_y=t.m_y-e.m_y,n.m_x=_.m_x-e.m_x,n.m_y=_.m_y-e.m_y,s.m_x=i.m_x-e.m_x,s.m_y=i.m_y-e.m_y,this.p_internal_between(this.p_internal_Vec2DotProduct(A,n),0,this.p_internal_Vec2DotProduct(n,n))&&this.p_internal_between(this.p_internal_Vec2DotProduct(A,s),0,this.p_internal_Vec2DotProduct(s,s))?!0:!1},c_ftObject.prototype.p_internal_Collided_CrossDistance=function(t,e,_){var i=0,A=0,n=0,s=c_tPointS.m_new.call(new c_tPointS),r=c_tPointS.m_new.call(new c_tPointS),a=c_tPointS.m_new.call(new c_tPointS),m=c_tPointS.m_new.call(new c_tPointS),o=0,h=0,c=0,p=0,l=0,u=0,d=0,g=0,f=0,b=0,y=0,v=0,x=0,S=0,w=0;return i=-1,s.m_x=t.m_p1.m_x,s.m_y=t.m_p1.m_y,r.m_x=t.m_p2.m_x,r.m_y=t.m_p2.m_y,a.m_x=e.m_p1.m_x,a.m_y=e.m_p1.m_y,m.m_x=e.m_p2.m_x,m.m_y=e.m_p2.m_y,o=r.m_x-s.m_x,h=0!=o?(r.m_y-s.m_y)/o:1e5,w=s.m_x-h*s.m_x,o=m.m_x-a.m_x,c=0!=o?(m.m_y-a.m_y)/o:1e5,A=a.m_y-c*a.m_x,n=c-h,bb_math_Abs2(n)<1e-4?(l=1e5,p=1e5):(l=(w*c-A*h)/n,p=(w-A)/n),0==r.m_x-s.m_x&&(p=s.m_x,l=c*p+A),0==m.m_x-a.m_x&&(p=a.m_x,l=h*p+w),u=bb_math_Min2(s.m_x,r.m_x),d=bb_math_Max2(s.m_x,r.m_x),g=bb_math_Min2(s.m_y,r.m_y),f=bb_math_Max2(s.m_y,r.m_y),b=bb_math_Min2(a.m_x,m.m_x),y=bb_math_Max2(a.m_x,m.m_x),v=bb_math_Min2(a.m_y,m.m_y),x=bb_math_Max2(a.m_y,m.m_y),u>p+_||p-_>d||g>l+_||l-_>f||b>p+_||p-_>y||v>l+_||l-_>x?i=-1:(S=Math.pow(p-s.m_x,2),S+=Math.pow(l-s.m_y,2),S=Math.sqrt(S),i=S),i},c_ftObject.prototype.p_internal_Box2Box=function(t,e){var _=c_tPointS.m_new.call(new c_tPointS),i=c_tPointS.m_new.call(new c_tPointS),A=c_tPointS.m_new.call(new c_tPointS),n=c_tPointS.m_new.call(new c_tPointS),s=c_tPointS.m_new.call(new c_tPointS),r=c_tPointS.m_new.call(new c_tPointS),a=c_tPointS.m_new.call(new c_tPointS),m=c_tPointS.m_new.call(new c_tPointS),o=c_tPointS.m_new.call(new c_tPointS),h=c_tPointS.m_new.call(new c_tPointS),c=c_tPointS.m_new.call(new c_tPointS),p=c_tPointS.m_new.call(new c_tPointS),l=c_tPointS.m_new.call(new c_tPointS),u=c_tPointS.m_new.call(new c_tPointS),d=c_tPointS.m_new.call(new c_tPointS),g=c_tPointS.m_new.call(new c_tPointS),f=c_tPointS.m_new.call(new c_tPointS),b=c_tPointS.m_new.call(new c_tPointS),y=c_tPointS.m_new.call(new c_tPointS),v=c_tPointS.m_new.call(new c_tPointS),x=c_tPointS.m_new.call(new c_tPointS),S=c_tPointS.m_new.call(new c_tPointS),w=c_tPointS.m_new.call(new c_tPointS),L=c_tPointS.m_new.call(new c_tPointS),j=[c_tLine2D.m_new.call(new c_tLine2D),c_tLine2D.m_new.call(new c_tLine2D),c_tLine2D.m_new.call(new c_tLine2D),c_tLine2D.m_new.call(new c_tLine2D)],O=[c_tLine2D.m_new.call(new c_tLine2D),c_tLine2D.m_new.call(new c_tLine2D),c_tLine2D.m_new.call(new c_tLine2D),c_tLine2D.m_new.call(new c_tLine2D)],C=c_tLine2D.m_new.call(new c_tLine2D),P=c_tLine2D.m_new.call(new c_tLine2D);if(0==this.p_internal_Circle2CircleInBox(t,e))return!1;if(_.m_x=t.m_x1c+t.m_xPos,_.m_y=t.m_y1c+t.m_yPos,i.m_x=t.m_x2c+t.m_xPos,i.m_y=t.m_y2c+t.m_yPos,A.m_x=t.m_x3c+t.m_xPos,A.m_y=t.m_y3c+t.m_yPos,n.m_x=t.m_x4c+t.m_xPos,n.m_y=t.m_y4c+t.m_yPos,s.m_x=e.m_x1c+e.m_xPos,s.m_y=e.m_y1c+e.m_yPos,r.m_x=e.m_x2c+e.m_xPos,r.m_y=e.m_y2c+e.m_yPos,a.m_x=e.m_x3c+e.m_xPos,a.m_y=e.m_y3c+e.m_yPos,m.m_x=e.m_x4c+e.m_xPos,m.m_y=e.m_y4c+e.m_yPos,this.p_internal_Collided_IsIn(s,_,i,n))return!0;if(this.p_internal_Collided_IsIn(r,_,i,n))return!0;if(this.p_internal_Collided_IsIn(a,_,i,n))return!0;if(this.p_internal_Collided_IsIn(m,_,i,n))return!0;if(this.p_internal_Collided_IsIn(_,s,r,m))return!0;if(this.p_internal_Collided_IsIn(i,s,r,m))return!0;if(this.p_internal_Collided_IsIn(A,s,r,m))return!0;if(this.p_internal_Collided_IsIn(n,s,r,m))return!0;o=j[0].m_p1,h=j[0].m_p2,c=j[1].m_p1,p=j[1].m_p2,l=j[2].m_p1,u=j[2].m_p2,d=j[3].m_p1,g=j[3].m_p2,f=O[0].m_p1,b=O[0].m_p2,y=O[1].m_p1,v=O[1].m_p2,x=O[2].m_p1,S=O[2].m_p2,w=O[3].m_p1,L=O[3].m_p2,o.m_x=_.m_x,o.m_y=_.m_y,h.m_x=i.m_x,h.m_y=i.m_y,c.m_x=i.m_x,c.m_y=i.m_y,p.m_x=A.m_x,p.m_y=A.m_y,l.m_x=A.m_x,l.m_y=A.m_y,u.m_x=n.m_x,u.m_y=n.m_y,d.m_x=n.m_x,d.m_y=n.m_y,g.m_x=_.m_x,g.m_y=_.m_y,f.m_x=s.m_x,f.m_y=s.m_y,b.m_x=r.m_x,b.m_y=r.m_y,y.m_x=r.m_x,y.m_y=r.m_y,v.m_x=a.m_x,v.m_y=a.m_y,x.m_x=a.m_x,x.m_y=a.m_y,S.m_x=m.m_x,S.m_y=m.m_y,w.m_x=m.m_x,w.m_y=m.m_y,L.m_x=s.m_x,L.m_y=s.m_y;
for(var E=0;3>=E;E+=1)for(var G=0;3>=G;G+=1)if(C=j[E],P=O[G],-1!=this.p_internal_Collided_CrossDistance(C,P,0))return!0;return!1},c_ftObject.prototype.p_internal_Bound2Bound=function(t,e){var _=0,i=0,A=0,n=0,s=0,r=0,a=0,m=0;return _=t.m_xPos+t.m_hOffX-t.m_w*t.m_scaleX*t.m_collScale/2,A=_+t.m_w*t.m_scaleX,s=t.m_yPos+t.m_hOffY-t.m_h*t.m_scaleY*t.m_collScale/2,a=s+t.m_h*t.m_scaleY,i=e.m_xPos+e.m_hOffX-e.m_w*e.m_scaleX*e.m_collScale/2,n=i+e.m_w*e.m_scaleX,r=e.m_yPos+e.m_hOffY-e.m_h*e.m_scaleY*e.m_collScale/2,m=r+e.m_h*e.m_scaleY,r>a?!1:s>m?!1:i>A?!1:_>n?!1:!0},c_ftObject.prototype.p_CheckCollision=function(t){if(0==t.m_deleted&&0==this.m_deleted&&t.m_collGroup>0&&t.m_isActive&&this.m_collWith[t.m_collGroup-1]>0){var e=this.m_collType;if(0==e){var _=t.m_collType;return 3==_?this.p_internal_Circle2LineObj(this,t):1==_||2==_?this.p_internal_Circle2Box(this,t):this.p_internal_Circle2Circle(this,t)}if(1==e){var i=t.m_collType;return 0==i?this.p_internal_Box2Circle(this,t):this.p_internal_Box2Box(this,t)}if(2==e){var A=t.m_collType;return 0==A?this.p_internal_Box2Circle(this,t):1==A||3==A?this.p_internal_Box2Box(this,t):this.p_internal_Bound2Bound(this,t)}if(3==e){var n=t.m_collType;return 0==n?this.p_internal_Circle2LineObj(t,this):this.p_internal_Box2Box(this,t)}return this.p_internal_Circle2Circle(this,t)}return!1},c_ftObject.prototype.p_SetSpeed=function(t,e){var _=0,i=0;_=9876.5==e?this.m_angle:e,i=_,t>this.m_speedMax&&(t=this.m_speedMax),t<this.m_speedMin&&(t=this.m_speedMin),this.m_speedX=Math.sin(_*D2R)*t,this.m_speedY=-Math.cos(_*D2R)*t,_=Math.atan2(this.m_speedY,this.m_speedX)*R2D+90,0>_?_+=360:_>360&&(_-=360),this.m_speedAngle=i,this.m_speed=t,this.m_speed>this.m_speedMax&&(this.m_speed=this.m_speedMax)},c_ftObject.prototype.p_CreateTimer=function(t,e,_){var i=c_ftTimer.m_new.call(new c_ftTimer);return i.m_engine=this.m_engine,i.m_currTime=this.m_engine.m_time,i.m_duration=e,i.m_id=t,i.m_intervall=e,i.m_loop=_,i.m_obj=this,i.m_timerNode=this.m_timerList.p_AddLast7(i),i},c_ftObject.prototype.p_SetTag=function(t){this.m_tag=t},c_ftObject.prototype.p_SetID=function(t){this.m_id=t},c_ftObject.prototype.p_Render3=function(t,e){var _=0,i=0,A=0,n=0,s=0,r=0,a=0,m=0,o=0,h=0,c=0,p=0,l=0,u=0,d=0,g=0,f=0,b=0,y=0,v=0,x=0,S=0;if(0==this.m_deleted){A=this.m_alpha*this.m_layer.m_alpha,this.m_engine.m_alpha!=A&&(bb_graphics_SetAlpha(A),this.m_engine.m_alpha=A),(this.m_engine.m_red!=this.m_red||this.m_engine.m_green!=this.m_green||this.m_engine.m_blue!=this.m_blue)&&(bb_graphics_SetColor(this.m_red,this.m_green,this.m_blue),this.m_engine.m_red=this.m_red,this.m_engine.m_green=this.m_green,this.m_engine.m_blue=this.m_blue),this.m_engine.m_blendMode!=this.m_blendMode&&(bb_graphics_SetBlend(this.m_blendMode),this.m_engine.m_blendMode=this.m_blendMode),s=this.m_isFlipV?-1*this.m_scaleY:this.m_scaleY,n=this.m_isFlipH?-1*this.m_scaleX:this.m_scaleX;var w=this.m_type;if(8==w)bb_graphics_DrawPoint(this.m_xPos+t,this.m_yPos+e);else if(9==w)bb_graphics_PushMatrix(),bb_graphics_Translate(this.m_xPos+t,this.m_yPos+e),bb_graphics_Rotate(360-this.m_angle),bb_graphics_Scale(this.m_scaleX,this.m_scaleY),bb_graphics_DrawCircle(-this.m_w*this.m_handleX+4,-this.m_h*this.m_handleY+4,4),bb_graphics_DrawLine(-this.m_w*this.m_handleX+4,-this.m_h*this.m_handleY+6,-this.m_w*this.m_handleX+4,-this.m_h*this.m_handleY+25),bb_graphics_DrawLine(-this.m_w*this.m_handleX+4,-this.m_h*this.m_handleY+14,-this.m_w*this.m_handleX+8,-this.m_h*this.m_handleY+18),bb_graphics_DrawLine(-this.m_w*this.m_handleX+4,-this.m_h*this.m_handleY+25,-this.m_w*this.m_handleX,-this.m_h*this.m_handleY+29),bb_graphics_DrawLine(-this.m_w*this.m_handleX+4,-this.m_h*this.m_handleY+25,-this.m_w*this.m_handleX+8,-this.m_h*this.m_handleY+29),bb_graphics_PopMatrix();else if(10==w)bb_graphics_PushMatrix(),bb_graphics_Translate(this.m_xPos+t,this.m_yPos+e),bb_graphics_Rotate(360-this.m_angle),bb_graphics_DrawOval(-this.m_w*this.m_handleX,-this.m_h*this.m_handleY,this.m_w,this.m_h),bb_graphics_PopMatrix();else if(11==w)bb_graphics_PushMatrix(),bb_graphics_Translate(this.m_xPos+t,this.m_yPos+e),bb_graphics_Rotate(360-this.m_angle+90),bb_graphics_DrawLine(-this.m_w*this.m_handleX,0,this.m_w-this.m_w*this.m_handleX,0),bb_graphics_PopMatrix();else if(12==w)bb_graphics_PushMatrix(),bb_graphics_Translate(this.m_xPos+t,this.m_yPos+e),bb_graphics_Rotate(360-this.m_angle),bb_graphics_Scale(this.m_scaleX,this.m_scaleY),bb_graphics_DrawPoly(this.m_verts),bb_graphics_PopMatrix();else if(0==w)f=this.m_hOffX+this.m_xPos+t,b=this.m_hOffY+this.m_yPos+e,1==this.m_isAnimated?f+this.m_w/2>=0&&f-this.m_w/2<=this.m_engine.p_GetCanvasWidth()&&b+this.m_h/2>=0&&b-this.m_h/2<=this.m_engine.p_GetCanvasHeight()&&(y=0|bb_math_Min2(this.m_frameCount-1,this.m_animTime/this.m_frameTime),bb_graphics_DrawImageRect2(this.m_objImg.m_img,f,b,0|this.m_rox,0|this.m_roy,0|this.m_rw,0|this.m_rh,360-this.m_angle+this.m_offAngle,n,s,bb_math_Min(y,this.m_objImg.m_img.p_Frames()-1))):f+this.m_w/2>=0&&f-this.m_w/2<=this.m_engine.m_canvasWidth&&b+this.m_h/2>=0&&b-this.m_h/2<=this.m_engine.m_canvasHeight&&bb_graphics_DrawImageRect2(this.m_objImg.m_img,f,b,0|this.m_rox,0|this.m_roy,0|this.m_rw,0|this.m_rh,360-this.m_angle+this.m_offAngle,n,s,0);else if(6==w){x=this.m_engine.p_GetCanvasWidth(),S=this.m_engine.p_GetCanvasHeight(),n+=this.m_tileModSX,s+=this.m_tileModSY,h=this.m_tileSizeX*this.m_scaleX,c=this.m_tileSizeY*this.m_scaleY,p=h/2,l=c/2,v=360-this.m_angle;var L=1,j=this.m_tileCountX;for(d=1;d<=this.m_tileCountX;d+=1)if(m=t+this.m_xPos+this.m_tileMap[d-1].m_xOff*this.m_scaleX,m+p>=0&&x>=m-p){L=d;break}for(d=L+1;d<=this.m_tileCountX;d+=1)if(m=t+this.m_xPos+this.m_tileMap[d-1].m_xOff*this.m_scaleX,0>m+p||m-p>x){j=d-1;break}var O=1,C=this.m_tileCountY;for(u=1;u<=this.m_tileCountY;u+=1)if(r=(u-1)*this.m_tileCountX,o=e+this.m_yPos+this.m_tileMap[r].m_yOff*this.m_scaleY,o+l>=0&&S>=o-l){O=u;break}for(u=O+1;u<=this.m_tileCountY;u+=1)if(r=(u-1)*this.m_tileCountX,o=e+this.m_yPos+this.m_tileMap[r].m_yOff*this.m_scaleY,0>o+l||o-l>S){C=u-1;break}for(u=O;C>=u;u+=1)for(d=L;j>=d;d+=1)r=d-1+(u-1)*this.m_tileCountX,a=this.m_tileMap[r].m_tileID,-1!=a&&(m=t+this.m_xPos+this.m_tileMap[r].m_xOff*this.m_scaleX,o=e+this.m_yPos+this.m_tileMap[r].m_yOff*this.m_scaleY,bb_graphics_DrawImageRect2(this.m_objImg.m_img,m,o,0|this.m_rox,0|this.m_roy,0|this.m_rw,0|this.m_rh,v,n,s,a))}else if(2==w)bb_graphics_PushMatrix(),bb_graphics_Translate(this.m_xPos+t,this.m_yPos+e),bb_graphics_Rotate(360-this.m_angle),bb_graphics_DrawCircle(-this.m_w*(this.m_handleX-.5),-this.m_h*(this.m_handleY-.5),this.m_radius*this.m_scaleX),bb_graphics_PopMatrix();else if(3==w)bb_graphics_PushMatrix(),bb_graphics_Translate(this.m_xPos+t,this.m_yPos+e),bb_graphics_Rotate(360-this.m_angle),bb_graphics_Scale(this.m_scaleX,this.m_scaleY),bb_graphics_DrawRect(-this.m_w*this.m_handleX,-this.m_h*this.m_handleY,this.m_w,this.m_h),bb_graphics_PopMatrix();else if(1==w){bb_graphics_PushMatrix(),bb_graphics_Translate(this.m_xPos+t,this.m_yPos+e),bb_graphics_Rotate(360-this.m_angle),bb_graphics_Scale(this.m_scaleX,this.m_scaleY);var P=this.m_textMode;0==P?(_=0,i=0):1==P?(_=-(this.m_objFont.p_Length(this.m_text)/2),i=0):2==P?(_=-this.m_objFont.p_Length(this.m_text),i=0):7==P?(_=0,i=-(this.m_objFont.p_Height()/2)):3==P?(_=-(this.m_objFont.p_Length(this.m_text)/2),i=-(this.m_objFont.p_Height()/2)):4==P?(_=-this.m_objFont.p_Length(this.m_text),i=-(this.m_objFont.p_Height()/2)):8==P?(_=0,i=-this.m_objFont.p_Height()):5==P?(_=-(this.m_objFont.p_Length(this.m_text)/2),i=-this.m_objFont.p_Height()):6==P&&(_=-this.m_objFont.p_Length(this.m_text),i=-this.m_objFont.p_Height()),this.m_objFont.p_Draw(this.m_text,_,i),bb_graphics_PopMatrix()}else if(7==w){bb_graphics_PushMatrix(),bb_graphics_Translate(this.m_xPos+t,this.m_yPos+e),bb_graphics_Rotate(360-this.m_angle),bb_graphics_Scale(this.m_scaleX,this.m_scaleY);var E=this.m_text.split("\n"),G=this.m_objFont.p_Height(),B=E.length;for(g=1;B>=g;g+=1){var N=this.m_textMode;0==N?(_=0,i=0+G*(g-1)):1==N?(_=-(this.m_objFont.p_Length(E[g-1])/2),i=0+G*(g-1)):2==N?(_=-this.m_objFont.p_Length(E[g-1]),i=0+G*(g-1)):7==N?(_=0,i=-(G*B/2)+G*(g-1)):3==N?(_=-(this.m_objFont.p_Length(E[g-1])/2),i=-(G*B/2)+G*(g-1)):4==N?(_=-this.m_objFont.p_Length(E[g-1]),i=-(G*B/2)+G*(g-1)):8==N?(_=0,i=-(G*B)+G*(g-1)):5==N?(_=-(this.m_objFont.p_Length(E[g-1])/2),i=-(G*B)+G*(g-1)):6==N&&(_=-this.m_objFont.p_Length(E[g-1]),i=-(G*B)+G*(g-1)),this.m_objFont.p_Draw(E[g-1],_,i)}bb_graphics_PopMatrix()}1==this.m_onRenderEvent&&this.m_engine.p_OnObjectRender(this);for(var D=this.m_childObjList.p_ObjectEnumerator();D.p_HasNext();){var M=D.p_NextObject();M.m_isVisible&&M.m_isActive&&M.p_Render3(t,e)}}},c_ftObject.prototype.p_AddSpeed=function(t,e){var _=0;_=9876.5==e?this.m_angle:e,this.m_speedX=this.m_speedX+Math.sin(_*D2R)*t,this.m_speedY=this.m_speedY-Math.cos(_*D2R)*t,_=Math.atan2(this.m_speedY,this.m_speedX)*R2D+90,0>_?_+=360:_>360&&(_-=360),this.m_speedAngle=_,this.m_speed=Math.sqrt(this.m_speedX*this.m_speedX+this.m_speedY*this.m_speedY),this.m_speed>this.m_speedMax&&(this.m_speed=this.m_speedMax)},c_List.m_new=function(){return this},c_List.prototype.p_AddLast=function(t){return c_Node.m_new.call(new c_Node,this.m__head,this.m__head.m__pred,t)},c_List.m_new2=function(t){for(var e=t,_=0;_<e.length;){var i=e[_];_+=1,this.p_AddLast(i)}return this},c_List.prototype.p_ObjectEnumerator=function(){return c_Enumerator2.m_new.call(new c_Enumerator2,this)},c_List.prototype.p_Backwards=function(){return c_BackwardsList2.m_new.call(new c_BackwardsList2,this)},c_lObjList.prototype=extend_class(c_List),c_lObjList.m_new=function(){return c_List.m_new.call(this),this},c_Node.m_new=function(t,e,_){return this.m__succ=t,this.m__pred=e,this.m__succ.m__pred=this,this.m__pred.m__succ=this,this.m__data=_,this},c_Node.m_new2=function(){return this},c_Node.prototype.p_Remove2=function(){return this.m__succ.m__pred=this.m__pred,this.m__pred.m__succ=this.m__succ,0},c_HeadNode.prototype=extend_class(c_Node),c_HeadNode.m_new=function(){return c_Node.m_new2.call(this),this.m__succ=this,this.m__pred=this,this},c_List2.m_new=function(){return this},c_List2.prototype.p_AddLast2=function(t){return c_Node2.m_new.call(new c_Node2,this.m__head,this.m__head.m__pred,t)},c_List2.m_new2=function(t){for(var e=t,_=0;_<e.length;){var i=e[_];_+=1,this.p_AddLast2(i)}return this},c_List2.prototype.p_ObjectEnumerator=function(){return c_Enumerator3.m_new.call(new c_Enumerator3,this)},c_Node2.m_new=function(t,e,_){return this.m__succ=t,this.m__pred=e,this.m__succ.m__pred=this,this.m__pred.m__succ=this,this.m__data=_,this},c_Node2.m_new2=function(){return this},c_HeadNode2.prototype=extend_class(c_Node2),c_HeadNode2.m_new=function(){return c_Node2.m_new2.call(this),this.m__succ=this,this.m__pred=this,this},c_ftScene.m_new=function(){return this},c_ftScene.prototype.p_AddLayer=function(t){this.m_layerList.p_AddLast2(t)},c_List3.m_new=function(){return this},c_List3.prototype.p_AddLast3=function(t){return c_Node3.m_new.call(new c_Node3,this.m__head,this.m__head.m__pred,t)},c_List3.m_new2=function(t){for(var e=t,_=0;_<e.length;){var i=e[_];_+=1,this.p_AddLast3(i)}return this},c_Node3.m_new=function(t,e,_){return this.m__succ=t,this.m__pred=e,this.m__succ.m__pred=this,this.m__pred.m__succ=this,this.m__data=_,this},c_Node3.m_new2=function(){return this},c_HeadNode3.prototype=extend_class(c_Node3),c_HeadNode3.m_new=function(){return c_Node3.m_new2.call(this),this.m__succ=this,this.m__pred=this,this},c_ftSwipe.m_new=function(){for(var t=0;9>=t;t+=1)this.m_startX[t]=0,this.m_startY[t]=0,this.m_endX[t]=0,this.m_endY[t]=0,this.m_diffX[t]=0,this.m_diffY[t]=0,this.m_startTime[t]=0,this.m_endTime[t]=0,this.m_diffTime[t]=0,this.m_touchActive[t]=!1,this.m_angle[t]=0,this.m_dist[t]=0,this.m_speed[t]=0;return this},c_ftImageManager.m_new=function(){return this},c_ftImageManager.prototype.p_LoadImage=function(t){for(var e=null,_=this.m_imageList.p_ObjectEnumerator();_.p_HasNext();){var i=_.p_NextObject();if(i.m_img==t){e=i;break}}return null==e&&(e=c_ftImage.m_new.call(new c_ftImage),e.m_engine=this.m_engine,e.m_path="",e.m_flags=c_Image.m_DefaultFlags,e.m_frameCount=1,e.m_img=t,e.m_imageNode=this.m_imageList.p_AddLast4(e)),e},c_ftImageManager.prototype.p_LoadImage2=function(t,e,_){for(var i=null,A=null,n=this.m_imageList.p_ObjectEnumerator();n.p_HasNext();){var s=n.p_NextObject();if(s.m_path==t){A=s;break}}return null==A&&(A=c_ftImage.m_new.call(new c_ftImage),A.m_engine=this.m_engine,A.m_path=t,A.m_flags=_,A.m_frameCount=e,i=bb_graphics_LoadImage(t,e,_),null==i&&error("ftImageManager.LoadImage\n\nCould not load image\n\n"+t),A.m_img=i,A.m_imageNode=this.m_imageList.p_AddLast4(A)),A},c_ftImageManager.prototype.p_LoadImage3=function(t,e,_,i,A){for(var n=null,s=null,r=this.m_imageList.p_ObjectEnumerator();r.p_HasNext();){var a=r.p_NextObject();if(a.m_path==t){s=a;break}}return null==s&&(s=c_ftImage.m_new.call(new c_ftImage),s.m_engine=this.m_engine,s.m_path=t,s.m_flags=A,s.m_frameCount=i,s.m_frameHeight=_,s.m_frameWidth=e,n=bb_graphics_LoadImage2(t,e,_,i,A),null==n&&error("ftImageManager.LoadImage\n\nCould not load image\n\n"+t),s.m_img=n,s.m_imageNode=this.m_imageList.p_AddLast4(s)),s},c_ftImageManager.prototype.p_GrabImage2=function(t,e,_,i,A,n,s){var r=null,a=null;return null==a&&(a=c_ftImage.m_new.call(new c_ftImage),a.m_engine=this.m_engine,a.m_atlas=t,a.m_flags=s,a.m_frameCount=n,a.m_frameHeight=A,a.m_frameWidth=i,a.m_frameStartX=e,a.m_frameStartY=_,a.m_isGrabed=!0,t.m_isAtlas=!0,r=t.m_img.p_GrabImage(e,_,i,A,n,s),null==r&&error("ftImageManager.GrabImage\n\nCould not grab image from atlas\n\n"),a.m_img=r,a.m_imageNode=this.m_imageList.p_AddLast4(a)),a},c_ftImageManager.prototype.p_GrabImage3=function(t,e,_,i,A,n,s){var r=null,a=null;if(null==a){a=c_ftImage.m_new.call(new c_ftImage),a.m_engine=this.m_engine,a.m_flags=s,a.m_frameCount=n,a.m_frameHeight=A,a.m_frameWidth=i,a.m_frameStartX=e,a.m_frameStartY=_,a.m_isGrabed=!0;for(var m=this.m_imageList.p_ObjectEnumerator();m.p_HasNext();){var o=m.p_NextObject();if(o.m_img==t){o.m_isAtlas=!0,a.m_atlas=o;break}}r=t.p_GrabImage(e,_,i,A,n,s),null==r&&error("ftImageManager.GrabImage\n\nCould not grab image from atlas\n\n"),a.m_img=r,a.m_imageNode=this.m_imageList.p_AddLast4(a)}return a};var bb_random_Seed=0;c_ftImage.m_new=function(){return this},c_List4.m_new=function(){return this},c_List4.prototype.p_AddLast4=function(t){return c_Node4.m_new.call(new c_Node4,this.m__head,this.m__head.m__pred,t)},c_List4.m_new2=function(t){for(var e=t,_=0;_<e.length;){var i=e[_];_+=1,this.p_AddLast4(i)}return this},c_List4.prototype.p_ObjectEnumerator=function(){return c_Enumerator.m_new.call(new c_Enumerator,this)},c_Node4.m_new=function(t,e,_){return this.m__succ=t,this.m__pred=e,this.m__succ.m__pred=this,this.m__pred.m__succ=this,this.m__data=_,this},c_Node4.m_new2=function(){return this},c_HeadNode4.prototype=extend_class(c_Node4),c_HeadNode4.m_new=function(){return c_Node4.m_new2.call(this),this.m__succ=this,this.m__pred=this,this},c_Enumerator.m_new=function(t){return this.m__list=t,this.m__curr=t.m__head.m__succ,this},c_Enumerator.m_new2=function(){return this},c_Enumerator.prototype.p_HasNext=function(){for(;this.m__curr.m__succ.m__pred!=this.m__curr;)this.m__curr=this.m__curr.m__succ;return this.m__curr!=this.m__list.m__head},c_Enumerator.prototype.p_NextObject=function(){var t=this.m__curr.m__data;return this.m__curr=this.m__curr.m__succ,t},c_Enumerator2.m_new=function(t){return this.m__list=t,this.m__curr=t.m__head.m__succ,this},c_Enumerator2.m_new2=function(){return this},c_Enumerator2.prototype.p_HasNext=function(){for(;this.m__curr.m__succ.m__pred!=this.m__curr;)this.m__curr=this.m__curr.m__succ;return this.m__curr!=this.m__list.m__head},c_Enumerator2.prototype.p_NextObject=function(){var t=this.m__curr.m__data;return this.m__curr=this.m__curr.m__succ,t},c_ftSound.m_new=function(){return this},c_ftSound.prototype.p_GetFreeSoundChannel=function(){for(var t=this.m_engine.m_maxSoundChannel,e=this.m_engine.m_firstSoundChannel,_=e;t-1>=_;_+=1)if(0==bb_audio_ChannelState(_))return _;return this.m_engine.m_nextSoundChannel+=1,this.m_engine.m_nextSoundChannel>=t&&(this.m_engine.m_nextSoundChannel=e),this.m_engine.m_nextSoundChannel},c_ftSound.prototype.p_Play=function(t){return 0==this.m_isMusic?(-1==t&&(t=this.p_GetFreeSoundChannel()),this.m_channel=t,null!=this.m_sound&&(bb_audio_PlaySound(this.m_sound,t,this.m_loop?1:0),bb_audio_SetChannelVolume(this.m_channel,this.m_volume*this.m_engine.m_volumeSFX),bb_audio_SetChannelPan(this.m_channel,this.m_pan),bb_audio_SetChannelRate(this.m_channel,this.m_rate))):(bb_audio_PlayMusic(this.m_name,this.m_loop?1:0),bb_audio_SetMusicVolume(this.m_volume*this.m_engine.m_volumeMUS)),this.m_isPaused=!1,this.m_channel},c_Sound.m_new=function(t){return this.m_sample=t,this},c_Sound.m_new2=function(){return this},c_List5.m_new=function(){return this},c_List5.prototype.p_AddLast5=function(t){return c_Node5.m_new.call(new c_Node5,this.m__head,this.m__head.m__pred,t)},c_List5.m_new2=function(t){for(var e=t,_=0;_<e.length;){var i=e[_];_+=1,this.p_AddLast5(i)}return this},c_Node5.m_new=function(t,e,_){return this.m__succ=t,this.m__pred=e,this.m__succ.m__pred=this,this.m__pred.m__succ=this,this.m__data=_,this},c_Node5.m_new2=function(){return this},c_HeadNode5.prototype=extend_class(c_Node5),c_HeadNode5.m_new=function(){return c_Node5.m_new2.call(this),this.m__succ=this,this.m__pred=this,this},c_ftFont.m_new=function(){return this},c_ftFont.prototype.p_Load=function(t){var e="",_=0,i="",A=null,n=0;if(t.indexOf("/",0)>-1){var s=t.split("/");n=s.length;for(var r=0;n-2>=r;r+=1)i=i+s[r]+"/"}var a=t.toLowerCase();e=a.indexOf(".txt",0)>0?bb_app_LoadString(t):bb_app_LoadString(t+".txt");for(var m=e.split(String.fromCharCode(10)),o=m,h=0;h<o.length;){var c=o[h];if(h+=1,c=string_trim(c),!string_startswith(c,"info")&&""!=c&&!string_startswith(c,"padding")){if(string_startswith(c,"common"))for(var p=c.split(String.fromCharCode(32)),l=p,u=0;u<l.length;){var d=l[u];if(u+=1,string_startswith(d,"lineHeight=")){var g=d.split("=");g[1]=string_trim(g[1]),this.m_lineHeight=parseInt(g[1],10)}if(string_startswith(d,"pages=")){var f=d.split("=");f[1]=string_trim(f[1]),this.m_pageCount=parseInt(f[1],10),this.m_pages=new_object_array(this.m_pageCount)}}if(string_startswith(c,"page"))for(var b=c.split(String.fromCharCode(32)),y=b,v=0;v<y.length;){var x=y[v];if(v+=1,string_startswith(x,"file=")){var S=x.split("=");S[1]=string_trim(S[1]),this.m_filename=S[1],34==this.m_filename.charCodeAt(0)&&(this.m_filename=this.m_filename.slice(1,this.m_filename.length-1)),this.m_filename=i+string_trim(this.m_filename),this.m_pages[_]=bb_graphics_LoadImage(this.m_filename,1,c_Image.m_DefaultFlags),null==this.m_pages[_]&&error("Error in method ftFont.Load\n\nCan not load page image: "+this.m_filename),_+=1}}if(!string_startswith(c,"chars")&&string_startswith(c,"char")){A=c_ftChar.m_new.call(new c_ftChar);for(var w=c.split(String.fromCharCode(32)),L=w,j=0;j<L.length;){var O=L[j];if(j+=1,string_startswith(O,"id=")){var C=O.split("=");C[1]=string_trim(C[1]),A.m_id=parseInt(C[1],10)}if(string_startswith(O,"x=")){var P=O.split("=");P[1]=string_trim(P[1]),A.m_x=parseInt(P[1],10)}if(string_startswith(O,"y=")){var E=O.split("=");E[1]=string_trim(E[1]),A.m_y=parseInt(E[1],10)}if(string_startswith(O,"width=")){var G=O.split("=");G[1]=string_trim(G[1]),A.m_width=parseInt(G[1],10)}if(string_startswith(O,"height=")){var B=O.split("=");B[1]=string_trim(B[1]),A.m_height=parseInt(B[1],10)}if(string_startswith(O,"xoffset=")){var N=O.split("=");N[1]=string_trim(N[1]),A.m_xoff=parseInt(N[1],10)}if(string_startswith(O,"yoffset=")){var D=O.split("=");D[1]=string_trim(D[1]),A.m_yoff=parseInt(D[1],10)}if(string_startswith(O,"xadvance=")){var M=O.split("=");M[1]=string_trim(M[1]),A.m_xadv=parseInt(M[1],10)}if(string_startswith(O,"page=")){var k=O.split("=");k[1]=string_trim(k[1]),A.m_page=parseInt(k[1],10)}}this.m_charMap.p_Add(A.m_id,A)}}}},c_ftFont.prototype.p_Length=function(t){for(var e=0,_=0,i=t.length,A=null,n=1;i>=n;n+=1)_=t.charCodeAt(n-1),A=this.m_charMap.p_Get(_),null!=A&&(e+=A.m_xadv);return e},c_ftFont.prototype.p_Height=function(){return this.m_lineHeight},c_ftFont.prototype.p_Draw=function(t,e,_){var i=0,A=0,n=0,s=null,r=t.length;i=e,A=_;for(var a=1;r>=a;a+=1)n=t.charCodeAt(a-1),s=this.m_charMap.p_Get(n),null!=s&&(bb_graphics_DrawImageRect(this.m_pages[s.m_page],i+s.m_xoff,A+s.m_yoff,s.m_x,s.m_y,s.m_width,s.m_height,0),i+=s.m_xadv)},c_ftChar.m_new=function(){return this},c_Map.m_new=function(){return this},c_Map.prototype.p_Compare=function(){},c_Map.prototype.p_RotateLeft=function(t){var e=t.m_right;return t.m_right=e.m_left,null!=e.m_left&&(e.m_left.m_parent=t),e.m_parent=t.m_parent,null!=t.m_parent?t==t.m_parent.m_left?t.m_parent.m_left=e:t.m_parent.m_right=e:this.m_root=e,e.m_left=t,t.m_parent=e,0},c_Map.prototype.p_RotateRight=function(t){var e=t.m_left;return t.m_left=e.m_right,null!=e.m_right&&(e.m_right.m_parent=t),e.m_parent=t.m_parent,null!=t.m_parent?t==t.m_parent.m_right?t.m_parent.m_right=e:t.m_parent.m_left=e:this.m_root=e,e.m_right=t,t.m_parent=e,0},c_Map.prototype.p_InsertFixup=function(t){for(;null!=t.m_parent&&-1==t.m_parent.m_color&&null!=t.m_parent.m_parent;)if(t.m_parent==t.m_parent.m_parent.m_left){var e=t.m_parent.m_parent.m_right;null!=e&&-1==e.m_color?(t.m_parent.m_color=1,e.m_color=1,e.m_parent.m_color=-1,t=e.m_parent):(t==t.m_parent.m_right&&(t=t.m_parent,this.p_RotateLeft(t)),t.m_parent.m_color=1,t.m_parent.m_parent.m_color=-1,this.p_RotateRight(t.m_parent.m_parent))}else{var _=t.m_parent.m_parent.m_left;null!=_&&-1==_.m_color?(t.m_parent.m_color=1,_.m_color=1,_.m_parent.m_color=-1,t=_.m_parent):(t==t.m_parent.m_left&&(t=t.m_parent,this.p_RotateRight(t)),t.m_parent.m_color=1,t.m_parent.m_parent.m_color=-1,this.p_RotateLeft(t.m_parent.m_parent))}return this.m_root.m_color=1,0},c_Map.prototype.p_Add=function(t,e){for(var _=this.m_root,i=null,A=0;null!=_;)if(i=_,A=this.p_Compare(t,_.m_key),A>0)_=_.m_right;else{if(!(0>A))return!1;_=_.m_left}return _=c_Node6.m_new.call(new c_Node6,t,e,-1,i),null!=i?(A>0?i.m_right=_:i.m_left=_,this.p_InsertFixup(_)):this.m_root=_,!0},c_Map.prototype.p_FindNode=function(t){for(var e=this.m_root;null!=e;){var _=this.p_Compare(t,e.m_key);if(_>0)e=e.m_right;else{if(!(0>_))return e;e=e.m_left}}return e},c_Map.prototype.p_Get=function(t){var e=this.p_FindNode(t);return null!=e?e.m_value:null},c_IntMap.prototype=extend_class(c_Map),c_IntMap.m_new=function(){return c_Map.m_new.call(this),this},c_IntMap.prototype.p_Compare=function(t,e){return t-e},c_Node6.m_new=function(t,e,_,i){return this.m_key=t,this.m_value=e,this.m_color=_,this.m_parent=i,this},c_Node6.m_new2=function(){return this},c_List6.m_new=function(){return this},c_List6.prototype.p_AddLast6=function(t){return c_Node7.m_new.call(new c_Node7,this.m__head,this.m__head.m__pred,t)},c_List6.m_new2=function(t){for(var e=t,_=0;_<e.length;){var i=e[_];_+=1,this.p_AddLast6(i)}return this},c_Node7.m_new=function(t,e,_){return this.m__succ=t,this.m__pred=e,this.m__succ.m__pred=this,this.m__pred.m__succ=this,this.m__data=_,this},c_Node7.m_new2=function(){return this},c_HeadNode6.prototype=extend_class(c_Node7),c_HeadNode6.m_new=function(){return c_Node7.m_new2.call(this),this.m__succ=this,this.m__pred=this,this},c_ftTimer.prototype.p_RemoveTimer=function(){null!=this.m_timerNode&&this.m_timerNode.p_Remove2(),this.m_timerNode=null,this.m_obj=null,this.m_engine=null},c_ftTimer.prototype.p_Update3=function(){var t=0,e=0;0==this.m_deleted&&(this.m_duration>0?(t=this.m_currTime,this.m_currTime=this.m_engine.m_time,e=this.m_currTime-t,1!=this.m_isPaused&&1!=this.m_engine.m_isPaused&&(this.m_duration-=e),this.m_duration<=0&&(null==this.m_obj?this.m_engine.p_OnTimer(this.m_id):this.m_engine.p_OnObjectTimer(this.m_id,this.m_obj),0==this.m_loop&&(null==this.m_obj?this.p_RemoveTimer():this.m_deleted=!0),-1==this.m_loop&&(this.m_duration+=this.m_intervall),this.m_loop>0&&(this.m_duration+=this.m_intervall,this.m_loop-=1))):this.m_deleted=!0)},c_ftTimer.m_new=function(){return this},c_List7.m_new=function(){return this},c_List7.prototype.p_AddLast7=function(t){return c_Node8.m_new.call(new c_Node8,this.m__head,this.m__head.m__pred,t)},c_List7.m_new2=function(t){for(var e=t,_=0;_<e.length;){var i=e[_];_+=1,this.p_AddLast7(i)}return this},c_List7.prototype.p_Backwards=function(){return c_BackwardsList.m_new.call(new c_BackwardsList,this)},c_List7.prototype.p_ObjectEnumerator=function(){return c_Enumerator6.m_new.call(new c_Enumerator6,this)},c_Node8.m_new=function(t,e,_){return this.m__succ=t,this.m__pred=e,this.m__succ.m__pred=this,this.m__pred.m__succ=this,this.m__data=_,this},c_Node8.m_new2=function(){return this},c_Node8.prototype.p_Remove2=function(){return this.m__succ.m__pred=this.m__pred,this.m__pred.m__succ=this.m__succ,0},c_HeadNode7.prototype=extend_class(c_Node8),c_HeadNode7.m_new=function(){return c_Node8.m_new2.call(this),this.m__succ=this,this.m__pred=this,this},c_BackwardsList.m_new=function(t){return this.m__list=t,this},c_BackwardsList.m_new2=function(){return this},c_BackwardsList.prototype.p_ObjectEnumerator=function(){return c_BackwardsEnumerator.m_new.call(new c_BackwardsEnumerator,this.m__list)},c_BackwardsEnumerator.m_new=function(t){return this.m__list=t,this.m__curr=t.m__head.m__pred,this},c_BackwardsEnumerator.m_new2=function(){return this},c_BackwardsEnumerator.prototype.p_HasNext=function(){for(;this.m__curr.m__pred.m__succ!=this.m__curr;)this.m__curr=this.m__curr.m__pred;return this.m__curr!=this.m__list.m__head},c_BackwardsEnumerator.prototype.p_NextObject=function(){var t=this.m__curr.m__data;return this.m__curr=this.m__curr.m__pred,t},c_Enumerator3.m_new=function(t){return this.m__list=t,this.m__curr=t.m__head.m__succ,this},c_Enumerator3.m_new2=function(){return this},c_Enumerator3.prototype.p_HasNext=function(){for(;this.m__curr.m__succ.m__pred!=this.m__curr;)this.m__curr=this.m__curr.m__succ;return this.m__curr!=this.m__list.m__head},c_Enumerator3.prototype.p_NextObject=function(){var t=this.m__curr.m__data;return this.m__curr=this.m__curr.m__succ,t},c_ftTrans.prototype.p_Update3=function(){var t=0,e=0;if(0==this.m_deleted&&(t=this.m_currTime,this.m_currTime=this.m_engine.m_time,e=this.m_currTime-t,1!=this.m_engine.m_isPaused&&1!=this.m_isPaused))if(this.m_duration-=e,this.m_duration<=0){for(var _=this.m_entryList.p_ObjectEnumerator();_.p_HasNext();){var i=_.p_NextObject();i.p_Update4(-1,this.m_tween)}0!=this.m_finishID&&(null!=this.m_obj?this.m_engine.p_OnObjectTransition(this.m_finishID,this.m_obj):this.m_engine.p_OnLayerTransition(this.m_finishID,this.m_layer)),this.m_deleted=!0}else for(var A=this.m_entryList.p_ObjectEnumerator();A.p_HasNext();){var n=A.p_NextObject();n.p_Update4(e,this.m_tween)}},c_ftTrans.prototype.p_Clear=function(){for(var t=this.m_entryList.p_ObjectEnumerator();t.p_HasNext();){var e=t.p_NextObject();e.m_obj=null,e.m_layer=null}this.m_entryList.p_Clear()},c_ftTrans.prototype.p_Cancel=function(){this.p_Clear(),this.m_transNode.p_Remove2(),this.m_transNode=null,this.m_obj=null,this.m_engine=null,this.m_layer=null},c_List8.m_new=function(){return this},c_List8.prototype.p_AddLast8=function(t){return c_Node9.m_new.call(new c_Node9,this.m__head,this.m__head.m__pred,t)},c_List8.m_new2=function(t){for(var e=t,_=0;_<e.length;){var i=e[_];_+=1,this.p_AddLast8(i)}return this},c_List8.prototype.p_ObjectEnumerator=function(){return c_Enumerator4.m_new.call(new c_Enumerator4,this)},c_Node9.m_new=function(t,e,_){return this.m__succ=t,this.m__pred=e,this.m__succ.m__pred=this,this.m__pred.m__succ=this,this.m__data=_,this},c_Node9.m_new2=function(){return this},c_Node9.prototype.p_Remove2=function(){return this.m__succ.m__pred=this.m__pred,this.m__pred.m__succ=this.m__succ,0},c_HeadNode8.prototype=extend_class(c_Node9),c_HeadNode8.m_new=function(){return c_Node9.m_new2.call(this),this.m__succ=this,this.m__pred=this,this},c_Enumerator4.m_new=function(t){return this.m__list=t,this.m__curr=t.m__head.m__succ,this},c_Enumerator4.m_new2=function(){return this},c_Enumerator4.prototype.p_HasNext=function(){for(;this.m__curr.m__succ.m__pred!=this.m__curr;)this.m__curr=this.m__curr.m__succ;return this.m__curr!=this.m__list.m__head},c_Enumerator4.prototype.p_NextObject=function(){var t=this.m__curr.m__data;return this.m__curr=this.m__curr.m__succ,t},c_ftTransEntry.prototype.p_Update4=function(t,e){if(this.m_timeLapsed=this.m_timeLapsed+t,null!=this.m_obj)if(-1==t){var _=this.m_typ;1==_?this.m_obj.p_SetPos(this.m_e_x,this.m_e_y,0):2==_?this.m_obj.p_SetAngle(this.m_e_rot,0):3==_?this.m_obj.p_SetScale(this.m_e_scale,0):4==_&&this.m_obj.p_SetAlpha(this.m_e_alpha,0)}else{var i=this.m_typ;1==i?(this.m_obj.p_SetPosX(e.m_equation.p_Call(this.m_timeLapsed,this.m_s_x,this.m_e_x-this.m_s_x,this.m_duration),0),this.m_obj.p_SetPosY(e.m_equation.p_Call(this.m_timeLapsed,this.m_s_y,this.m_e_y-this.m_s_y,this.m_duration),0)):2==i?this.m_obj.p_SetAngle(this.m_rot*t,1):3==i?this.m_obj.p_SetScale(this.m_scale*t,1):4==i&&this.m_obj.p_SetAlpha(this.m_alpha*t,1)}else if(-1==t){var A=this.m_typ;1==A?this.m_layer.p_SetPos(this.m_e_x,this.m_e_y,0):3==A?this.m_layer.p_SetScale(this.m_e_scale,0):4==A&&this.m_layer.p_SetAlpha(this.m_e_alpha,0)}else{var n=this.m_typ;1==n?this.m_layer.p_SetPos(this.m_x*t,this.m_y*t,1):3==n?this.m_layer.p_SetScale(this.m_scale*t,1):4==n&&this.m_layer.p_SetAlpha(this.m_alpha*t,1)}},c_List9.m_new=function(){return this},c_List9.prototype.p_AddLast9=function(t){return c_Node10.m_new.call(new c_Node10,this.m__head,this.m__head.m__pred,t)},c_List9.m_new2=function(t){for(var e=t,_=0;_<e.length;){var i=e[_];_+=1,this.p_AddLast9(i)}return this},c_List9.prototype.p_ObjectEnumerator=function(){return c_Enumerator5.m_new.call(new c_Enumerator5,this)},c_List9.prototype.p_Clear=function(){return this.m__head.m__succ=this.m__head,this.m__head.m__pred=this.m__head,0},c_Node10.m_new=function(t,e,_){return this.m__succ=t,this.m__pred=e,this.m__succ.m__pred=this,this.m__pred.m__succ=this,this.m__data=_,this},c_Node10.m_new2=function(){return this},c_HeadNode9.prototype=extend_class(c_Node10),c_HeadNode9.m_new=function(){return c_Node10.m_new2.call(this),this.m__succ=this,this.m__pred=this,this},c_Enumerator5.m_new=function(t){return this.m__list=t,this.m__curr=t.m__head.m__succ,this},c_Enumerator5.m_new2=function(){return this},c_Enumerator5.prototype.p_HasNext=function(){for(;this.m__curr.m__succ.m__pred!=this.m__curr;)this.m__curr=this.m__curr.m__succ;return this.m__curr!=this.m__list.m__head},c_Enumerator5.prototype.p_NextObject=function(){var t=this.m__curr.m__data;return this.m__curr=this.m__curr.m__succ,t},c_TweenEquationCall.prototype.p_Call=function(){},c_Enumerator6.m_new=function(t){return this.m__list=t,this.m__curr=t.m__head.m__succ,this},c_Enumerator6.m_new2=function(){return this},c_Enumerator6.prototype.p_HasNext=function(){for(;this.m__curr.m__succ.m__pred!=this.m__curr;)this.m__curr=this.m__curr.m__succ;return this.m__curr!=this.m__list.m__head},c_Enumerator6.prototype.p_NextObject=function(){var t=this.m__curr.m__data;return this.m__curr=this.m__curr.m__succ,t},c_BackwardsList2.m_new=function(t){return this.m__list=t,this},c_BackwardsList2.m_new2=function(){return this},c_BackwardsList2.prototype.p_ObjectEnumerator=function(){return c_BackwardsEnumerator2.m_new.call(new c_BackwardsEnumerator2,this.m__list)},c_BackwardsEnumerator2.m_new=function(t){return this.m__list=t,this.m__curr=t.m__head.m__pred,this},c_BackwardsEnumerator2.m_new2=function(){return this},c_BackwardsEnumerator2.prototype.p_HasNext=function(){for(;this.m__curr.m__pred.m__succ!=this.m__curr;)this.m__curr=this.m__curr.m__pred;return this.m__curr!=this.m__list.m__head},c_BackwardsEnumerator2.prototype.p_NextObject=function(){var t=this.m__curr.m__data;return this.m__curr=this.m__curr.m__pred,t},c_tPointS.m_new=function(){return this},c_tLine2D.m_new=function(){return this.m_p1=c_tPointS.m_new.call(new c_tPointS),this.m_p2=c_tPointS.m_new.call(new c_tPointS),this
},c_ftHighScoreList.m_new=function(){return this},c_ftHighScoreList.prototype.p_LoadFromString=function(t){this.m_entryList.p_Clear();for(var e=t.split(String.fromCharCode(10)),_=e,i=0;i<_.length;){var A=_[i];if(i+=1,""!=A)if(string_startswith(A,"count=")){var n=A.split("=");this.m_entryCount=parseInt(n[1],10)}else{var s=A.split("="),r=c_ftHighScoreEntry.m_new.call(new c_ftHighScoreEntry);r.m_value=parseInt(s[0],10),r.m_name=s[1],this.m_entryList.p_AddLast10(r)}}},c_ftHighScoreList.prototype.p_Count=function(){return this.m_entryList.p_Count()},c_ftHighScoreList.prototype.p_GetValue=function(t){for(var e=0,_=this.m_entryList.p_ObjectEnumerator();_.p_HasNext();){var i=_.p_NextObject();if(e+=1,e==t)return i.m_value}return 0},c_ftHighScoreList.prototype.p_SortList=function(){for(var t=new_object_array(64),e=c_ftHighScoreEntry.m_new.call(new c_ftHighScoreEntry),_=0,i=!1,A=1;A<=this.m_entryCount;A+=1)t[A-1]=c_ftHighScoreEntry.m_new.call(new c_ftHighScoreEntry);for(var n=this.m_entryList.p_ObjectEnumerator();n.p_HasNext();){var s=n.p_NextObject();_+=1,t[_-1].m_value=s.m_value,t[_-1].m_name=s.m_name}do{i=!1;for(var r=2;_>=r;r+=1)t[r-1].m_value>t[r-2].m_value&&(e.m_value=t[r-2].m_value,e.m_name=t[r-2].m_name,t[r-2].m_value=t[r-1].m_value,t[r-2].m_name=t[r-1].m_name,t[r-1].m_value=e.m_value,t[r-1].m_name=e.m_name,i=!0)}while(0!=i);_=0;for(var a=this.m_entryList.p_ObjectEnumerator();a.p_HasNext();){var m=a.p_NextObject();m.m_value=t[_].m_value,m.m_name=t[_].m_name,_+=1}},c_ftHighScoreList.prototype.p_AddScore=function(t,e){var _=0,i=0;i+=1;for(var A=this.m_entryList.p_ObjectEnumerator();A.p_HasNext();){var n=A.p_NextObject();if(t>=n.m_value)break;i+=1}if(i<=this.m_entryCount){this.m_entryList.p_Count()==this.m_entryCount&&this.m_entryList.p_RemoveLast();var s=c_ftHighScoreEntry.m_new.call(new c_ftHighScoreEntry);s.m_value=t,s.m_name=e,this.m_entryList.p_AddLast10(s),_=i,this.m_entryList.p_Count()>1&&this.p_SortList()}return _},c_ftHighScoreList.prototype.p_SaveToString=function(){var t="";t="count="+String(this.m_entryCount)+String.fromCharCode(10);for(var e=this.m_entryList.p_ObjectEnumerator();e.p_HasNext();){var _=e.p_NextObject();t=t+String(_.m_value)+"="+_.m_name+String.fromCharCode(10)}return t},c_ftHighScoreEntry.m_new=function(){return this},c_List10.m_new=function(){return this},c_List10.prototype.p_AddLast10=function(t){return c_Node11.m_new.call(new c_Node11,this.m__head,this.m__head.m__pred,t)},c_List10.m_new2=function(t){for(var e=t,_=0;_<e.length;){var i=e[_];_+=1,this.p_AddLast10(i)}return this},c_List10.prototype.p_Clear=function(){return this.m__head.m__succ=this.m__head,this.m__head.m__pred=this.m__head,0},c_List10.prototype.p_Count=function(){for(var t=0,e=this.m__head.m__succ;e!=this.m__head;)e=e.m__succ,t+=1;return t},c_List10.prototype.p_ObjectEnumerator=function(){return c_Enumerator7.m_new.call(new c_Enumerator7,this)},c_List10.prototype.p_RemoveLast=function(){var t=this.m__head.p_PrevNode().m__data;return this.m__head.m__pred.p_Remove2(),t},c_List10.prototype.p_Equals=function(t,e){return t==e},c_List10.prototype.p_FindLast=function(t,e){for(;e!=this.m__head;){if(this.p_Equals(t,e.m__data))return e;e=e.m__pred}return null},c_List10.prototype.p_FindLast2=function(t){return this.p_FindLast(t,this.m__head.m__pred)},c_List10.prototype.p_RemoveLast2=function(t){var e=this.p_FindLast2(t);null!=e&&e.p_Remove2()},c_Node11.m_new=function(t,e,_){return this.m__succ=t,this.m__pred=e,this.m__succ.m__pred=this,this.m__pred.m__succ=this,this.m__data=_,this},c_Node11.m_new2=function(){return this},c_Node11.prototype.p_GetNode=function(){return this},c_Node11.prototype.p_PrevNode=function(){return this.m__pred.p_GetNode()},c_Node11.prototype.p_Remove2=function(){return this.m__succ.m__pred=this.m__pred,this.m__pred.m__succ=this.m__succ,0},c_HeadNode10.prototype=extend_class(c_Node11),c_HeadNode10.m_new=function(){return c_Node11.m_new2.call(this),this.m__succ=this,this.m__pred=this,this},c_HeadNode10.prototype.p_GetNode=function(){return null},c_Enumerator7.m_new=function(t){return this.m__list=t,this.m__curr=t.m__head.m__succ,this},c_Enumerator7.m_new2=function(){return this},c_Enumerator7.prototype.p_HasNext=function(){for(;this.m__curr.m__succ.m__pred!=this.m__curr;)this.m__curr=this.m__curr.m__succ;return this.m__curr!=this.m__list.m__head},c_Enumerator7.prototype.p_NextObject=function(){var t=this.m__curr.m__data;return this.m__curr=this.m__curr.m__succ,t};